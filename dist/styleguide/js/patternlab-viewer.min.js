function receiveIframeMessage(e){if("file:"==window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host){var t,n={};try{n="string"!=typeof e.data?e.data:JSON.parse(e.data)}catch(r){}if(void 0!==n.event&&"patternLab.updatePath"==n.event)if(void 0!==patternData.patternPartial){var o=/(patterns|snapshots)\/(.*)$/;t=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(o,"")+n.path+"?"+Date.now(),window.location.replace(t)}else t=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("styleguide/html/styleguide.html","")+n.path+"?"+Date.now(),window.location.replace(t);else void 0!==n.event&&"patternLab.reload"==n.event&&window.location.reload()}}!function(e,t,n){function r(e){return e}function o(e){return decodeURIComponent(e.replace(i," "))}var i=/\+/g,s=e.cookie=function(i,a,p){if(a!==n){if(p=e.extend({},s.defaults,p),null===a&&(p.expires=-1),"number"==typeof p.expires){var l=p.expires,c=p.expires=new Date;c.setDate(c.getDate()+l)}return a=s.json?JSON.stringify(a):String(a),t.cookie=[encodeURIComponent(i),"=",s.raw?a:encodeURIComponent(a),p.expires?"; expires="+p.expires.toUTCString():"",p.path?"; path="+p.path:"",p.domain?"; domain="+p.domain:"",p.secure?"; secure":""].join("")}for(var u=s.raw?r:o,f=t.cookie.split("; "),d=0,h=f.length;d<h;d++){var g=f[d].split("=");if(u(g.shift())===i){var y=u(g.join("="));return s.json?JSON.parse(y):y}}return null};s.defaults={},e.removeCookie=function(t,n){return null!==e.cookie(t)&&(e.cookie(t,null,n),!0)}}(jQuery,document);var DataSaver={cookieName:"patternlab",addValue:function(e,t){var n=$.cookie(this.cookieName);n=null===n||""===n?e+"~"+t:n+"|"+e+"~"+t,$.cookie(this.cookieName,n)},updateValue:function(e,t){if(this.findValue(e)){for(var n="",r=$.cookie(this.cookieName).split("|"),o=0;o<r.length;o++){var i=r[o].split("~");i[0]==e&&(i[1]=t),n+=o>0?"|"+i[0]+"~"+i[1]:i[0]+"~"+i[1]}$.cookie(this.cookieName,n)}else this.addValue(e,t)},removeValue:function(e){for(var t="",n=$.cookie(this.cookieName).split("|"),r=0,o=0;o<n.length;o++){var i=n[o].split("~");i[0]!=e&&(t+=0===r?i[0]+"~"+i[1]:"|"+i[0]+"~"+i[1],r++)}$.cookie(this.cookieName,t)},findValue:function(e){if($.cookie(this.cookieName))for(var t=$.cookie(this.cookieName).split("|"),n=0;n<t.length;n++){var r=t[n].split("~");if(r[0]==e)return r[1]}return!1}};!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(function(){try{return require("fs")}catch(e){}}(),require("path")):"function"==typeof define&&define.amd?define(["fs","path"],t):"object"==typeof exports?exports.Twig=t(function(){try{return require("fs")}catch(e){}}(),require("path")):e.Twig=t(e.fs,e.path)}(this,function(e,t){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r={VERSION:"0.10.2"};n(1)(r),n(2)(r),n(3)(r),n(5)(r),n(6)(r),n(7)(r),n(17)(r),n(18)(r),n(21)(r),n(22)(r),n(23)(r),n(24)(r),n(25)(r),n(26)(r),n(27)(r),e.exports=r.exports},function(e,t){e.exports=function(e){"use strict";function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return void 0!==t&&null!==t&&n===e}return e.trace=!1,e.debug=!1,e.cache=!0,e.noop=function(){},e.placeholders={parent:"{{|PARENT|}}"},e.indexOf=function(e,t){if(Array.prototype.hasOwnProperty("indexOf"))return e.indexOf(t);if(void 0===e||null===e)throw new TypeError;var n=Object(e),r=n.length>>>0;if(0===r)return-1;var o=0;if(arguments.length>0&&(o=Number(arguments[1]),o!==o?o=0:0!==o&&o!==1/0&&o!==-(1/0)&&(o=(o>0||-1)*Math.floor(Math.abs(o)))),o>=r)return-1;for(var i=o>=0?o:Math.max(r-Math.abs(o),0);i<r;i++)if(i in n&&n[i]===t)return i;return e==t?0:-1},e.forEach=function(e,t,n){if(Array.prototype.forEach)return e.forEach(t,n);var r,o;if(null==e)throw new TypeError(" this is null or not defined");var i=Object(e),s=i.length>>>0;if("[object Function]"!={}.toString.call(t))throw new TypeError(t+" is not a function");for(n&&(r=n),o=0;o<s;){var a;o in i&&(a=i[o],t.call(r,a,o,i)),o++}},e.merge=function(t,n,r){return e.forEach(Object.keys(n),function(e){(!r||e in t)&&(t[e]=n[e])}),t},e.Error=function(e,t){this.message=e,this.name="TwigException",this.type="TwigException",this.file=t},e.Error.prototype.toString=function(){var e=this.name+": "+this.message;return e},e.log={trace:function(){e.trace&&console&&console.log(Array.prototype.slice.call(arguments))},debug:function(){e.debug&&console&&console.log(Array.prototype.slice.call(arguments))}},"undefined"!=typeof console?"undefined"!=typeof console.error?e.log.error=function(){console.error.apply(console,arguments)}:"undefined"!=typeof console.log&&(e.log.error=function(){console.log.apply(console,arguments)}):e.log.error=function(){},e.ChildContext=function(e){var t=function(){};return t.prototype=e,new t},e.token={},e.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw",output_whitespace_pre:"output_whitespace_pre",output_whitespace_post:"output_whitespace_post",output_whitespace_both:"output_whitespace_both",logic_whitespace_pre:"logic_whitespace_pre",logic_whitespace_post:"logic_whitespace_post",logic_whitespace_both:"logic_whitespace_both"},e.token.definitions=[{type:e.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:e.token.type.raw,open:"{% verbatim %}",close:"{% endverbatim %}"},{type:e.token.type.output_whitespace_pre,open:"{{-",close:"}}"},{type:e.token.type.output_whitespace_post,open:"{{",close:"-}}"},{type:e.token.type.output_whitespace_both,open:"{{-",close:"-}}"},{type:e.token.type.logic_whitespace_pre,open:"{%-",close:"%}"},{type:e.token.type.logic_whitespace_post,open:"{%",close:"-%}"},{type:e.token.type.logic_whitespace_both,open:"{%-",close:"-%}"},{type:e.token.type.output,open:"{{",close:"}}"},{type:e.token.type.logic,open:"{%",close:"%}"},{type:e.token.type.comment,open:"{#",close:"#}"}],e.token.strings=['"',"'"],e.token.findStart=function(t){var n,r,o,i,s={position:null,close_position:null,def:null};for(n=0;n<e.token.definitions.length;n++)r=e.token.definitions[n],o=t.indexOf(r.open),i=t.indexOf(r.close),e.log.trace("Twig.token.findStart: ","Searching for ",r.open," found at ",o),o>=0&&r.open.length!==r.close.length&&i<0||(o>=0&&(null===s.position||o<s.position)?(s.position=o,s.def=r,s.close_position=i):o>=0&&null!==s.position&&o===s.position&&(r.open.length>s.def.open.length?(s.position=o,s.def=r,s.close_position=i):r.open.length===s.def.open.length&&(r.close.length>s.def.close.length?i>=0&&i<s.close_position&&(s.position=o,s.def=r,s.close_position=i):i>=0&&i<s.close_position&&(s.position=o,s.def=r,s.close_position=i))));return delete s.close_position,s},e.token.findEnd=function(t,n,r){for(var o,i,s=null,a=!1,p=0,l=null,c=null,u=null,f=null,d=null,h=null;!a;){if(l=null,c=null,u=t.indexOf(n.close,p),!(u>=0))throw new e.Error("Unable to find closing bracket '"+n.close+"' opened near template position "+r);if(s=u,a=!0,n.type===e.token.type.comment)break;if(n.type===e.token.type.raw)break;for(i=e.token.strings.length,o=0;o<i;o+=1)d=t.indexOf(e.token.strings[o],p),d>0&&d<u&&(null===l||d<l)&&(l=d,c=e.token.strings[o]);if(null!==l)for(f=l+1,s=null,a=!1;;){if(h=t.indexOf(c,f),h<0)throw"Unclosed string in template";if("\\"!==t.substr(h-1,1)){p=h+1;break}f=h+1}}return s},e.tokenize=function(t){for(var n=[],r=0,o=null,i=null;t.length>0;)if(o=e.token.findStart(t),e.log.trace("Twig.tokenize: ","Found token: ",o),null!==o.position){if(o.position>0&&n.push({type:e.token.type.raw,value:t.substring(0,o.position)}),t=t.substr(o.position+o.def.open.length),r+=o.position+o.def.open.length,i=e.token.findEnd(t,o.def,r),e.log.trace("Twig.tokenize: ","Token ends at ",i),n.push({type:o.def.type,value:t.substring(0,i).trim()}),"\n"===t.substr(i+o.def.close.length,1))switch(o.def.type){case"logic_whitespace_pre":case"logic_whitespace_post":case"logic_whitespace_both":case"logic":i+=1}t=t.substr(i+o.def.close.length),r+=i+o.def.close.length}else n.push({type:e.token.type.raw,value:t}),t="";return n},e.compile=function(t){try{for(var n=[],r=[],o=[],i=null,s=null,a=null,p=null,l=null,c=null,u=null,f=null,d=null,h=null,g=null,y=null,m=function(t){e.expression.compile.apply(this,[t]),r.length>0?o.push(t):n.push(t)},v=function(t){if(s=e.logic.compile.apply(this,[t]),h=s.type,g=e.logic.handler[h].open,y=e.logic.handler[h].next,e.log.trace("Twig.compile: ","Compiled logic token to ",s," next is: ",y," open is : ",g),void 0!==g&&!g){if(p=r.pop(),u=e.logic.handler[p.type],e.indexOf(u.next,h)<0)throw new Error(h+" not expected after a "+p.type);p.output=p.output||[],p.output=p.output.concat(o),o=[],d={type:e.token.type.logic,token:p},r.length>0?o.push(d):n.push(d)}void 0!==y&&y.length>0?(e.log.trace("Twig.compile: ","Pushing ",s," to logic stack."),r.length>0&&(p=r.pop(),p.output=p.output||[],p.output=p.output.concat(o),r.push(p),o=[]),r.push(s)):void 0!==g&&g&&(d={type:e.token.type.logic,token:s},r.length>0?o.push(d):n.push(d))};t.length>0;){switch(i=t.shift(),l=n[n.length-1],c=o[o.length-1],f=t[0],e.log.trace("Compiling token ",i),i.type){case e.token.type.raw:r.length>0?o.push(i):n.push(i);break;case e.token.type.logic:v.call(this,i);break;case e.token.type.comment:break;case e.token.type.output:m.call(this,i);break;case e.token.type.logic_whitespace_pre:case e.token.type.logic_whitespace_post:case e.token.type.logic_whitespace_both:case e.token.type.output_whitespace_pre:case e.token.type.output_whitespace_post:case e.token.type.output_whitespace_both:switch(i.type!==e.token.type.output_whitespace_post&&i.type!==e.token.type.logic_whitespace_post&&(l&&l.type===e.token.type.raw&&(n.pop(),null===l.value.match(/^\s*$/)&&(l.value=l.value.trim(),n.push(l))),c&&c.type===e.token.type.raw&&(o.pop(),null===c.value.match(/^\s*$/)&&(c.value=c.value.trim(),o.push(c)))),i.type){case e.token.type.output_whitespace_pre:case e.token.type.output_whitespace_post:case e.token.type.output_whitespace_both:m.call(this,i);break;case e.token.type.logic_whitespace_pre:case e.token.type.logic_whitespace_post:case e.token.type.logic_whitespace_both:v.call(this,i)}i.type!==e.token.type.output_whitespace_pre&&i.type!==e.token.type.logic_whitespace_pre&&f&&f.type===e.token.type.raw&&(t.shift(),null===f.value.match(/^\s*$/)&&(f.value=f.value.trim(),t.unshift(f)))}e.log.trace("Twig.compile: "," Output: ",n," Logic Stack: ",r," Pending Output: ",o)}if(r.length>0)throw a=r.pop(),new Error("Unable to find an end tag for "+a.type+", expecting one of "+a.next);return n}catch(w){if(this.options.rethrow)throw"TwigException"!=w.type||w.file||(w.file=this.id),w;e.log.error("Error compiling twig template "+this.id+": "),w.stack?e.log.error(w.stack):e.log.error(w.toString())}},e.parse=function(t,n,r){function o(t){if(i.options.rethrow)throw"string"==typeof t&&(t=new e.Error(t)),"TwigException"!=t.type||t.file||(t.file=i.id),t;if(e.log.error("Error parsing twig template "+i.id+": "),t.stack?e.log.error(t.stack):e.log.error(t.toString()),e.debug)return t.toString()}var i=this,s=[],a=null,p=!0,l=null,c=!0;if(l=e.async.forEach(t,function(t){switch(e.log.debug("Twig.parse: ","Parsing token: ",t),t.type){case e.token.type.raw:s.push(e.filters.raw(t.value));break;case e.token.type.logic:var r=t.token;return e.logic.parseAsync.apply(i,[r,n,c]).then(function(e){void 0!==e.chain&&(c=e.chain),void 0!==e.context&&(n=e.context),void 0!==e.output&&s.push(e.output)});case e.token.type.comment:break;case e.token.type.output_whitespace_pre:case e.token.type.output_whitespace_post:case e.token.type.output_whitespace_both:case e.token.type.output:return e.log.debug("Twig.parse: ","Output token: ",t.stack),e.expression.parseAsync.apply(i,[t.stack,n]).then(function(e){s.push(e)})}}).then(function(){return s=e.output.apply(i,[s]),p=!1,s})["catch"](function(e){r&&o(e),a=e}),r)return l;if(null!==a)return o(a);if(p)throw new e.Error("You are using Twig.js in sync mode in combination with async extensions.");return s},e.prepare=function(t){var n,r;return e.log.debug("Twig.prepare: ","Tokenizing ",t),r=e.tokenize.apply(this,[t]),e.log.debug("Twig.prepare: ","Compiling ",r),n=e.compile.apply(this,[r]),e.log.debug("Twig.prepare: ","Compiled ",n),n},e.output=function(t){if(!this.options.autoescape)return t.join("");var n="html";"string"==typeof this.options.autoescape&&(n=this.options.autoescape);var r=[];return e.forEach(t,function(t){t&&t.twig_markup!==!0&&t.twig_markup!=n&&(t=e.filters.escape(t,[n])),r.push(t)}),e.Markup(r.join(""))},e.Templates={loaders:{},parsers:{},registry:{}},e.validateId=function(t){if("prototype"===t)throw new e.Error(t+" is not a valid twig identifier");if(e.cache&&e.Templates.registry.hasOwnProperty(t))throw new e.Error("There is already a template with the ID "+t);return!0},e.Templates.registerLoader=function(t,n,r){if("function"!=typeof n)throw new e.Error("Unable to add loader for "+t+": Invalid function reference given.");r&&(n=n.bind(r)),this.loaders[t]=n},e.Templates.unRegisterLoader=function(e){this.isRegisteredLoader(e)&&delete this.loaders[e]},e.Templates.isRegisteredLoader=function(e){return this.loaders.hasOwnProperty(e)},e.Templates.registerParser=function(t,n,r){if("function"!=typeof n)throw new e.Error("Unable to add parser for "+t+": Invalid function regerence given.");r&&(n=n.bind(r)),this.parsers[t]=n},e.Templates.unRegisterParser=function(e){this.isRegisteredParser(e)&&delete this.parsers[e]},e.Templates.isRegisteredParser=function(e){return this.parsers.hasOwnProperty(e)},e.Templates.save=function(t){if(void 0===t.id)throw new e.Error("Unable to save template with no id");e.Templates.registry[t.id]=t},e.Templates.load=function(t){return e.Templates.registry.hasOwnProperty(t)?e.Templates.registry[t]:null},e.Templates.loadRemote=function(t,n,r,o){var i;return void 0===n.async&&(n.async=!0),void 0===n.id&&(n.id=t),e.cache&&e.Templates.registry.hasOwnProperty(n.id)?("function"==typeof r&&r(e.Templates.registry[n.id]),e.Templates.registry[n.id]):(n.parser=n.parser||"twig",i=this.loaders[n.method]||this.loaders.fs,i.apply(this,arguments))},e.Template=function(n){var r=n.data,o=n.id,i=n.blocks,s=n.macros||{},a=n.base,p=n.path,l=n.url,c=n.name,u=n.method,f=n.options;this.id=o,this.method=u,this.base=a,this.path=p,this.url=l,this.name=c,this.macros=s,this.options=f,this.reset(i),t("String",r)?this.tokens=e.prepare.apply(this,[r]):this.tokens=r,void 0!==o&&e.Templates.save(this)},e.Template.prototype.reset=function(t){e.log.debug("Twig.Template.reset","Reseting template "+this.id),this.blocks={},this.importedBlocks=[],this.originalBlockTokens={},this.child={blocks:t||{}},this.extend=null},e.Template.prototype.render=function(t,n,r){n=n||{};var o,i,s=this,a=null,p=!0,l=null;this.context=t||{},this.reset(),n.blocks&&(this.blocks=n.blocks),n.macros&&(this.macros=n.macros);var c=function(t){if(s.extend){var r;return s.options.allowInlineIncludes&&(r=e.Templates.load(s.extend),r&&(r.options=s.options)),r||(i=e.path.parsePath(s,s.extend),r=e.Templates.loadRemote(i,{method:s.getLoaderMethod(),base:s.base,async:!1,id:i,options:s.options})),s.parent=r,s.parent.renderAsync(s.context,{blocks:s.blocks})}return"blocks"==n.output?s.blocks:"macros"==n.output?s.macros:t};if(l=e.parseAsync.apply(this,[this.tokens,this.context]).then(c).then(function(e){return p=!1,o=e,e})["catch"](function(e){if(r)throw e;a=e}),r)return l;if(null!==a)throw a;if(p)throw new e.Error("You are using Twig.js in sync mode in combination with async extensions.");return o},e.Template.prototype.importFile=function(t){var n,r;if(!this.url&&this.options.allowInlineIncludes){if(t=this.path?e.path.parsePath(this,t):t,r=e.Templates.load(t),!r&&(r=e.Templates.loadRemote(n,{id:t,method:this.getLoaderMethod(),async:!1,path:t,options:this.options}),!r))throw new e.Error("Unable to find the template "+t);return r.options=this.options,r}return n=e.path.parsePath(this,t),r=e.Templates.loadRemote(n,{method:this.getLoaderMethod(),base:this.base,async:!1,options:this.options,id:n})},e.Template.prototype.importBlocks=function(t,n){var r=this.importFile(t),o=this.context,i=this;n=n||!1,r.render(o),e.forEach(Object.keys(r.blocks),function(e){(n||void 0===i.blocks[e])&&(i.blocks[e]=r.blocks[e],i.importedBlocks.push(e))})},e.Template.prototype.importMacros=function(t){var n=e.path.parsePath(this,t),r=e.Templates.loadRemote(n,{method:this.getLoaderMethod(),async:!1,id:n});return r},e.Template.prototype.getLoaderMethod=function(){return this.path?"fs":this.url?"ajax":this.method||"fs"},e.Template.prototype.compile=function(t){return e.compiler.compile(this,t)},e.Markup=function(e,t){return"undefined"==typeof t&&(t=!0),"string"==typeof e&&e.length>0&&(e=new String(e),e.twig_markup=t),e},e}},function(e,t){e.exports=function(e){return e.compiler={module:{}},e.compiler.compile=function(t,n){var r,o=JSON.stringify(t.tokens),i=t.id;if(n.module){if(void 0===e.compiler.module[n.module])throw new e.Error("Unable to find module type "+n.module);r=e.compiler.module[n.module](i,o,n.twig)}else r=e.compiler.wrap(i,o);return r},e.compiler.module={amd:function(t,n,r){return'define(["'+r+'"], function (Twig) {\n\tvar twig, templates;\ntwig = Twig.twig;\ntemplates = '+e.compiler.wrap(t,n)+"\n\treturn templates;\n});"},node:function(t,n){return'var twig = require("twig").twig;\nexports.template = '+e.compiler.wrap(t,n)},cjs2:function(t,n,r){return'module.declare([{ twig: "'+r+'" }], function (require, exports, module) {\n\tvar twig = require("twig").twig;\n\texports.template = '+e.compiler.wrap(t,n)+"\n});"}},e.compiler.wrap=function(e,t){return'twig({id:"'+e.replace('"','\\"')+'", data:'+t+", precompiled: true});\n"},e}},function(e,t,n){e.exports=function(e){"use strict";function t(t,n,r){return n?e.expression.parseAsync.apply(t,[n,r]):e.Promise.resolve(!1)}e.expression={},n(4)(e),e.expression.reservedWords=["true","false","null","TRUE","FALSE","NULL","_context","and","b-and","or","b-or","b-xor","in","not in","if"],e.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",slice:"Twig.expression.type.slice",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},subexpression:{start:"Twig.expression.type.subexpression.start",end:"Twig.expression.type.subexpression.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},e.expression.set={operations:[e.expression.type.filter,e.expression.type.operator.unary,e.expression.type.operator.binary,e.expression.type.array.end,e.expression.type.object.end,e.expression.type.parameter.end,e.expression.type.subexpression.end,e.expression.type.comma,e.expression.type.test],expressions:[e.expression.type._function,e.expression.type.bool,e.expression.type.string,e.expression.type.variable,e.expression.type.number,e.expression.type._null,e.expression.type.context,e.expression.type.parameter.start,e.expression.type.array.start,e.expression.type.object.start,e.expression.type.subexpression.start,e.expression.type.operator.unary]},e.expression.set.operations_extended=e.expression.set.operations.concat([e.expression.type.key.period,e.expression.type.key.brackets,e.expression.type.slice]),e.expression.fn={compile:{push:function(e,t,n){n.push(e)},push_both:function(e,t,n){n.push(e),t.push(e)}},parse:{push:function(e,t,n){t.push(e)},push_value:function(e,t,n){t.push(e.value)}}},e.expression.definitions=[{type:e.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*(\s?as)?)/,next:e.expression.set.operations.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.filter=e.match[2],e.modifier=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(n,r,o){var i=r.pop();return t(this,n.params,o).then(function(t){var o=e.test(n.filter,i,t);"not"==n.modifier?r.push(!o):r.push(o)})}},{type:e.expression.type.comma,regex:/^,/,next:e.expression.set.expressions.concat([e.expression.type.array.end,e.expression.type.object.end]),compile:function(t,n,r){var o,i=n.length-1;for(delete t.match,delete t.value;i>=0;i--){if(o=n.pop(),o.type===e.expression.type.object.start||o.type===e.expression.type.parameter.start||o.type===e.expression.type.array.start){n.push(o);break}r.push(o)}r.push(t)}},{type:e.expression.type.number,regex:/^\-?\d+(\.\d+)?/,next:e.expression.set.operations,compile:function(e,t,n){e.value=Number(e.value),n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.operator.binary,regex:/(^\?\:|^(b\-and)|^(b\-or)|^(b\-xor)|^[\+\-~%\?]|^[\:](?!\d\])|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^(and)[\(|\s+]|^(or)[\(|\s+]|^(in)[\(|\s+]|^(not in)[\(|\s+]|^\.\.)/,next:e.expression.set.expressions,transform:function(e,t){switch(e[0]){case"and(":case"or(":case"in(":case"not in(":return t[t.length-1].value=e[2],e[0];default:return""}},compile:function(t,n,r){delete t.match,t.value=t.value.trim();var o=t.value,i=e.expression.operator.lookup(o,t);for(e.log.trace("Twig.expression.compile: ","Operator: ",i," from ",o);n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(i.associativity===e.expression.operator.leftToRight&&i.precidence>=n[n.length-1].precidence||i.associativity===e.expression.operator.rightToLeft&&i.precidence>n[n.length-1].precidence);){var s=n.pop();r.push(s)}if(":"===o){if(!n[n.length-1]||"?"!==n[n.length-1].value){var a=r.pop();if(a.type===e.expression.type.string||a.type===e.expression.type.variable)t.key=a.value;else if(a.type===e.expression.type.number)t.key=a.value.toString();else{if(!a.expression||a.type!==e.expression.type.parameter.end&&a.type!=e.expression.type.subexpression.end)throw new e.Error("Unexpected value before ':' of "+a.type+" = "+a.value);t.params=a.params}return void r.push(t)}}else n.push(i)},parse:function(t,n,r){if(t.key)n.push(t);else{if(t.params)return e.expression.parseAsync.apply(this,[t.params,r]).then(function(e){t.key=e,n.push(t),r.loop||delete t.params});e.expression.operator.parse(t.value,n)}}},{type:e.expression.type.operator.unary,regex:/(^not\s+)/,next:e.expression.set.expressions,compile:function(t,n,r){delete t.match,t.value=t.value.trim();var o=t.value,i=e.expression.operator.lookup(o,t);for(e.log.trace("Twig.expression.compile: ","Operator: ",i," from ",o);n.length>0&&(n[n.length-1].type==e.expression.type.operator.unary||n[n.length-1].type==e.expression.type.operator.binary)&&(i.associativity===e.expression.operator.leftToRight&&i.precidence>=n[n.length-1].precidence||i.associativity===e.expression.operator.rightToLeft&&i.precidence>n[n.length-1].precidence);){var s=n.pop();r.push(s)}n.push(i)},parse:function(t,n,r){e.expression.operator.parse(t.value,n)}},{type:e.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2[\s\S])*?\1/,next:e.expression.set.operations_extended,compile:function(t,n,r){var o=t.value;delete t.match,o='"'===o.substring(0,1)?o.replace('\\"','"'):o.replace("\\'","'"),t.value=o.substring(1,o.length-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),e.log.trace("Twig.expression.compile: ","String value: ",t.value),r.push(t)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.subexpression.start,regex:/^\(/,next:e.expression.set.expressions.concat([e.expression.type.subexpression.end]),compile:function(e,t,n){e.value="(",n.push(e),t.push(e)},parse:e.expression.fn.parse.push},{type:e.expression.type.subexpression.end,regex:/^\)/,next:e.expression.set.operations_extended,validate:function(t,n){for(var r=n.length-1,o=!1,i=!1,s=0;!o&&r>=0;){var a=n[r];o=a.type===e.expression.type.subexpression.start,o&&i&&(i=!1,o=!1),a.type===e.expression.type.parameter.start?s++:a.type===e.expression.type.parameter.end?s--:a.type===e.expression.type.subexpression.end&&(i=!0),r--}return o&&0===s},compile:function(t,n,r){var o,i=t;for(o=n.pop();n.length>0&&o.type!=e.expression.type.subexpression.start;)r.push(o),o=n.pop();for(var s=[];t.type!==e.expression.type.subexpression.start;)s.unshift(t),t=r.pop();s.unshift(t);o=n[n.length-1],void 0===o||o.type!==e.expression.type._function&&o.type!==e.expression.type.filter&&o.type!==e.expression.type.test&&o.type!==e.expression.type.key.brackets?(i.expression=!0,s.pop(),s.shift(),i.params=s,r.push(i)):(i.expression=!1,o.params=s)},parse:function(t,n,r){if(t.expression)return e.expression.parseAsync.apply(this,[t.params,r]).then(function(e){n.push(e)});throw new e.Error("Unexpected subexpression end when token is not marked as an expression")}},{type:e.expression.type.parameter.start,regex:/^\(/,next:e.expression.set.expressions.concat([e.expression.type.parameter.end]),validate:function(t,n){var r=n[n.length-1];return r&&e.indexOf(e.expression.reservedWords,r.value.trim())<0},compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.parameter.end,regex:/^\)/,next:e.expression.set.operations_extended,compile:function(t,n,r){var o,i=t;for(o=n.pop();n.length>0&&o.type!=e.expression.type.parameter.start;)r.push(o),o=n.pop();for(var s=[];t.type!==e.expression.type.parameter.start;)s.unshift(t),t=r.pop();s.unshift(t);t=r[r.length-1],void 0===t||t.type!==e.expression.type._function&&t.type!==e.expression.type.filter&&t.type!==e.expression.type.test&&t.type!==e.expression.type.key.brackets?(i.expression=!0,s.pop(),s.shift(),i.params=s,r.push(i)):(i.expression=!1,t.params=s)},parse:function(t,n,r){var o=[],i=!1,s=null;if(t.expression)return e.expression.parseAsync.apply(this,[t.params,r]).then(function(e){n.push(e)});for(;n.length>0;){if(s=n.pop(),s&&s.type&&s.type==e.expression.type.parameter.start){i=!0;break}o.unshift(s)}if(!i)throw new e.Error("Expected end of parameter set.");n.push(o)}},{type:e.expression.type.slice,regex:/^\[(\d*\:\d*)\]/,next:e.expression.set.operations_extended,compile:function(e,t,n){var r=e.match[1].split(":"),o=r[0]?parseInt(r[0]):void 0,i=r[1]?parseInt(r[1]):void 0;e.value="slice",e.params=[o,i],i||(e.params=[o]),n.push(e)},parse:function(t,n,r){var o=n.pop(),i=t.params;n.push(e.filter.apply(this,[t.value,o,i]))}},{type:e.expression.type.array.start,regex:/^\[/,next:e.expression.set.expressions.concat([e.expression.type.array.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.array.end,regex:/^\]/,next:e.expression.set.operations_extended,compile:function(t,n,r){for(var o,i=n.length-1;i>=0&&(o=n.pop(),o.type!==e.expression.type.array.start);i--)r.push(o);r.push(t)},parse:function(t,n,r){for(var o=[],i=!1,s=null;n.length>0;){if(s=n.pop(),s.type&&s.type==e.expression.type.array.start){i=!0;break}o.unshift(s)}if(!i)throw new e.Error("Expected end of array.");n.push(o)}},{type:e.expression.type.object.start,regex:/^\{/,next:e.expression.set.expressions.concat([e.expression.type.object.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.object.end,regex:/^\}/,next:e.expression.set.operations_extended,compile:function(t,n,r){for(var o,i=n.length-1;i>=0&&(o=n.pop(),!o||o.type!==e.expression.type.object.start);i--)r.push(o);r.push(t)},parse:function(t,n,r){for(var o={},i=!1,s=null,a=!1,p=null;n.length>0;){if(s=n.pop(),s&&s.type&&s.type===e.expression.type.object.start){i=!0;break}if(s&&s.type&&(s.type===e.expression.type.operator.binary||s.type===e.expression.type.operator.unary)&&s.key){if(!a)throw new e.Error("Missing value for key '"+s.key+"' in object definition.");o[s.key]=p,void 0===o._keys&&(o._keys=[]),o._keys.unshift(s.key),p=null,a=!1}else a=!0,p=s}if(!i)throw new e.Error("Unexpected end of object.");n.push(o)}},{type:e.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_\-]*)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.value=e.match[1],n.push(e)},parse:function(n,r,o){var i=this,s=r.pop();return t(this,n.params,o).then(function(t){return e.filter.apply(i,[n.value,s,t])}).then(function(e){r.push(e)})}},{type:e.expression.type._function,regex:/^([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/,next:e.expression.type.parameter.start,validate:function(t,n){return t[1]&&e.indexOf(e.expression.reservedWords,t[1])<0},transform:function(e,t){return"("},compile:function(e,t,n){var r=e.match[1];e.fn=r,delete e.match,delete e.value,n.push(e)},parse:function(n,r,o){var i,s=this,a=n.fn;return t(this,n.params,o).then(function(t){if(e.functions[a])i=e.functions[a].apply(s,t);else{if("function"!=typeof o[a])throw new e.Error(a+" function does not exist and is not defined in the context");i=o[a].apply(o,t)}return i}).then(function(e){r.push(e)})}},{type:e.expression.type.variable,regex:/^[a-zA-Z_][a-zA-Z0-9_]*/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,validate:function(t,n){return e.indexOf(e.expression.reservedWords,t[0])<0},parse:function(t,n,r){return e.expression.resolveAsync.apply(this,[r[t.value],r]).then(function(e){n.push(e)})}},{type:e.expression.type.key.period,regex:/^\.([a-zA-Z0-9_]+)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,n){e.key=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(n,r,o,i){var s,a=this,p=n.key,l=r.pop();return t(this,n.params,o).then(function(t){if(null===l||void 0===l){if(a.options.strict_variables)throw new e.Error("Can't access a key "+p+" on an null or undefined object.");s=void 0}else{var n=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)};s="object"==typeof l&&p in l?l[p]:void 0!==l["get"+n(p)]?l["get"+n(p)]:void 0!==l["is"+n(p)]?l["is"+n(p)]:void 0}return e.expression.resolveAsync.apply(a,[s,o,t,i,l])}).then(function(e){r.push(e)})}},{type:e.expression.type.key.brackets,regex:/^\[([^\]\:]*)\]/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(t,n,r){var o=t.match[1];delete t.value,delete t.match,t.stack=e.expression.compile({value:o}).stack,r.push(t)},parse:function(n,r,o,i){var s,a,p=this,l=null;return t(this,n.params,o).then(function(t){return l=t,e.expression.parseAsync.apply(p,[n.stack,o])}).then(function(t){if(s=r.pop(),null===s||void 0===s){if(p.options.strict_variables)throw new e.Error("Can't access a key "+t+" on an null or undefined object.");return null}return a="object"==typeof s&&t in s?s[t]:null,e.expression.resolveAsync.apply(p,[a,s,l,i])}).then(function(e){r.push(e)})}},{type:e.expression.type._null,regex:/^(null|NULL|none|NONE)/,next:e.expression.set.operations,compile:function(e,t,n){delete e.match,e.value=null,n.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.context,regex:/^_context/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,parse:function(e,t,n){t.push(n)}},{type:e.expression.type.bool,regex:/^(true|TRUE|false|FALSE)/,next:e.expression.set.operations,compile:function(e,t,n){e.value="true"===e.match[0].toLowerCase(),delete e.match,n.push(e)},parse:e.expression.fn.parse.push_value}],e.expression.resolveAsync=function(t,n,r,o,i){if("function"==typeof t){var s=e.Promise.resolve(r);if(o&&o.type===e.expression.type.parameter.end){var a=!0;s=s.then(function(){return o.params&&e.expression.parseAsync.apply(this,[o.params,n,a])}).then(function(e){return o.cleanup=!0,e})}return s.then(function(e){return t.apply(i||n,e||[])})}return e.Promise.resolve(t)},e.expression.resolve=function(t,n,r,o,i){
var s,a=!0;if(e.expression.resolveAsync.apply(this,[t,n,r,o,i]).then(function(e){a=!1,s=e}),a)throw new e.Error("You are using Twig.js in sync mode in combination with async extensions.");return s},e.expression.handler={},e.expression.extendType=function(t){e.expression.type[t]="Twig.expression.type."+t},e.expression.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);e.expression.handler[t.type]=t};for(;e.expression.definitions.length>0;)e.expression.extend(e.expression.definitions.shift());return e.expression.tokenize=function(t){var n,r,o,i,s,a,p=[],l=0,c=null,u=[];for(a=function(){var t=Array.prototype.slice.apply(arguments);t.pop(),t.pop();return e.log.trace("Twig.expression.tokenize","Matched a ",n," regular expression of ",t),c&&e.indexOf(c,n)<0?(u.push(n+" cannot follow a "+p[p.length-1].type+" at template:"+l+" near '"+t[0].substring(0,20)+"...'"),t[0]):e.expression.handler[n].validate&&!e.expression.handler[n].validate(t,p)?t[0]:(u=[],p.push({type:n,value:t[0],match:t}),s=!0,c=i,l+=t[0].length,e.expression.handler[n].transform?e.expression.handler[n].transform(t,p):"")},e.log.debug("Twig.expression.tokenize","Tokenizing expression ",t);t.length>0;){t=t.trim();for(n in e.expression.handler)if(e.expression.handler.hasOwnProperty(n)){for(i=e.expression.handler[n].next,r=e.expression.handler[n].regex,e.log.trace("Checking type ",n," on ",t),o=r instanceof Array?r:[r],s=!1;o.length>0;)r=o.pop(),t=t.replace(r,a);if(s)break}if(!s)throw u.length>0?new e.Error(u.join(" OR ")):new e.Error("Unable to parse '"+t+"' at template position"+l)}return e.log.trace("Twig.expression.tokenize","Tokenized to ",p),p},e.expression.compile=function(t){var n=t.value,r=e.expression.tokenize(n),o=null,i=[],s=[],a=null;for(e.log.trace("Twig.expression.compile: ","Compiling ",n);r.length>0;)o=r.shift(),a=e.expression.handler[o.type],e.log.trace("Twig.expression.compile: ","Compiling ",o),a.compile&&a.compile(o,s,i),e.log.trace("Twig.expression.compile: ","Stack is",s),e.log.trace("Twig.expression.compile: ","Output is",i);for(;s.length>0;)i.push(s.pop());return e.log.trace("Twig.expression.compile: ","Final output is",i),t.stack=i,delete t.value,t},e.expression.parse=function(t,n,r,o){var i=this;t instanceof Array||(t=[t]);var s,a=[],p=null,l=!0,c=null,u=[];if(p=e.async.forEach(t,function(r,o){if(!r.cleanup){var p=null;return t.length>o+1&&(s=t[o+1]),c=e.expression.handler[r.type],c.parse&&(p=c.parse.apply(i,[r,a,n,s])),n.loop&&r.type===e.expression.type.operator.binary&&u.push(r),p}}).then(function(){if(e.forEach(u,function(e){e.params&&e.key&&delete e.key}),r){for(var t=[];a.length>0;)t.unshift(a.pop());a.push(t)}if(o)return e.Promise.resolve(a.pop())}).then(function(e){return l=!1,e}),o)return p;if(l)throw new e.Error("You are using Twig.js in sync mode in combination with async extensions.");return a.pop()},e}},function(e,t){e.exports=function(e){"use strict";e.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};var t=function(e,t){if(void 0===t||null===t)return null;if(void 0!==t.indexOf)return e===t||""!==e&&t.indexOf(e)>-1;var n;for(n in t)if(t.hasOwnProperty(n)&&t[n]===e)return!0;return!1};return e.expression.operator.lookup=function(t,n){switch(t){case"..":n.precidence=20,n.associativity=e.expression.operator.leftToRight;break;case",":n.precidence=18,n.associativity=e.expression.operator.leftToRight;break;case"?:":case"?":case":":n.precidence=16,n.associativity=e.expression.operator.rightToLeft;break;case"or":n.precidence=14,n.associativity=e.expression.operator.leftToRight;break;case"and":n.precidence=13,n.associativity=e.expression.operator.leftToRight;break;case"b-or":n.precidence=12,n.associativity=e.expression.operator.leftToRight;break;case"b-xor":n.precidence=11,n.associativity=e.expression.operator.leftToRight;break;case"b-and":n.precidence=10,n.associativity=e.expression.operator.leftToRight;break;case"==":case"!=":n.precidence=9,n.associativity=e.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":case"not in":case"in":n.precidence=8,n.associativity=e.expression.operator.leftToRight;break;case"~":case"+":case"-":n.precidence=6,n.associativity=e.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":n.precidence=5,n.associativity=e.expression.operator.leftToRight;break;case"not":n.precidence=3,n.associativity=e.expression.operator.rightToLeft;break;default:throw new e.Error("Failed to lookup operator: "+t+" is an unknown operator.")}return n.operator=t,n},e.expression.operator.parse=function(n,r){e.log.trace("Twig.expression.operator.parse: ","Handling ",n);var o,i,s;switch("?"===n&&(s=r.pop()),i=r.pop(),"not"!==n&&(o=r.pop()),"in"!==n&&"not in"!==n&&(o&&Array.isArray(o)&&(o=o.length),i&&Array.isArray(i)&&(i=i.length)),n){case":":break;case"?:":e.lib.boolval(o)?r.push(o):r.push(i);break;case"?":void 0===o&&(o=i,i=s,s=void 0),e.lib.boolval(o)?r.push(i):r.push(s);break;case"+":i=parseFloat(i),o=parseFloat(o),r.push(o+i);break;case"-":i=parseFloat(i),o=parseFloat(o),r.push(o-i);break;case"*":i=parseFloat(i),o=parseFloat(o),r.push(o*i);break;case"/":i=parseFloat(i),o=parseFloat(o),r.push(o/i);break;case"//":i=parseFloat(i),o=parseFloat(o),r.push(Math.floor(o/i));break;case"%":i=parseFloat(i),o=parseFloat(o),r.push(o%i);break;case"~":r.push((null!=o?o.toString():"")+(null!=i?i.toString():""));break;case"not":case"!":r.push(!e.lib.boolval(i));break;case"<":r.push(o<i);break;case"<=":r.push(o<=i);break;case">":r.push(o>i);break;case">=":r.push(o>=i);break;case"===":r.push(o===i);break;case"==":r.push(o==i);break;case"!==":r.push(o!==i);break;case"!=":r.push(o!=i);break;case"or":r.push(o||i);break;case"b-or":r.push(o|i);break;case"b-xor":r.push(o^i);break;case"and":r.push(o&&i);break;case"b-and":r.push(o&i);break;case"**":r.push(Math.pow(o,i));break;case"not in":r.push(!t(o,i));break;case"in":r.push(t(o,i));break;case"..":r.push(e.functions.range(o,i));break;default:throw new e.Error("Failed to parse operator: "+n+" is an unknown operator.")}},e}},function(e,t){e.exports=function(e){function t(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return void 0!==t&&null!==t&&n===e}return e.filters={upper:function(e){return"string"!=typeof e?e:e.toUpperCase()},lower:function(e){return"string"!=typeof e?e:e.toLowerCase()},capitalize:function(e){return"string"!=typeof e?e:e.substr(0,1).toUpperCase()+e.toLowerCase().substr(1)},title:function(e){return"string"!=typeof e?e:e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})},length:function(t){return e.lib.is("Array",t)||"string"==typeof t?t.length:e.lib.is("Object",t)?void 0===t._keys?Object.keys(t).length:t._keys.length:0},reverse:function(e){if(t("Array",e))return e.reverse();if(t("String",e))return e.split("").reverse().join("");if(t("Object",e)){var n=e._keys||Object.keys(e).reverse();return e._keys=n,e}},sort:function(e){if(t("Array",e))return e.sort();if(t("Object",e)){delete e._keys;var n=Object.keys(e),r=n.sort(function(t,n){var r;return e[t]>e[n]==!(e[t]<=e[n])?e[t]>e[n]?1:e[t]<e[n]?-1:0:isNaN(r=parseFloat(e[t]))||isNaN(b1=parseFloat(e[n]))?"string"==typeof e[t]?e[t]>e[n].toString()?1:e[t]<e[n].toString()?-1:0:"string"==typeof e[n]?e[t].toString()>e[n]?1:e[t].toString()<e[n]?-1:0:null:r>b1?1:r<b1?-1:0});return e._keys=r,e}},keys:function(t){if(void 0!==t&&null!==t){var n=t._keys||Object.keys(t),r=[];return e.forEach(n,function(e){"_keys"!==e&&t.hasOwnProperty(e)&&r.push(e)}),r}},url_encode:function(e){if(void 0!==e&&null!==e){var t=encodeURIComponent(e);return t=t.replace("'","%27")}},join:function(n,r){if(void 0!==n&&null!==n){var o="",i=[],s=null;return r&&r[0]&&(o=r[0]),t("Array",n)?i=n:(s=n._keys||Object.keys(n),e.forEach(s,function(e){"_keys"!==e&&n.hasOwnProperty(e)&&i.push(n[e])})),i.join(o)}},"default":function(t,n){if(void 0!==n&&n.length>1)throw new e.Error("default filter expects one argument");return void 0===t||null===t||""===t?void 0===n?"":n[0]:t},json_encode:function(n){if(void 0===n||null===n)return"null";if("object"==typeof n&&t("Array",n))return o=[],e.forEach(n,function(t){o.push(e.filters.json_encode(t))}),"["+o.join(",")+"]";if("object"==typeof n){var r=n._keys||Object.keys(n),o=[];return e.forEach(r,function(t){o.push(JSON.stringify(t)+":"+e.filters.json_encode(n[t]))}),"{"+o.join(",")+"}"}return JSON.stringify(n)},merge:function(n,r){var o=[],i=0,s=[];if(t("Array",n)?e.forEach(r,function(e){t("Array",e)||(o={})}):o={},t("Array",o)||(o._keys=[]),t("Array",n)?e.forEach(n,function(e){o._keys&&o._keys.push(i),o[i]=e,i++}):(s=n._keys||Object.keys(n),e.forEach(s,function(e){o[e]=n[e],o._keys.push(e);var t=parseInt(e,10);!isNaN(t)&&t>=i&&(i=t+1)})),e.forEach(r,function(n){t("Array",n)?e.forEach(n,function(e){o._keys&&o._keys.push(i),o[i]=e,i++}):(s=n._keys||Object.keys(n),e.forEach(s,function(e){o[e]||o._keys.push(e),o[e]=n[e];var t=parseInt(e,10);!isNaN(t)&&t>=i&&(i=t+1)}))}),0===r.length)throw new e.Error("Filter merge expects at least one parameter");return o},date:function(t,n){var r=e.functions.date(t),o=n&&n.length?n[0]:"F j, Y H:i";return e.lib.date(o,r)},date_modify:function(t,n){if(void 0!==t&&null!==t){if(void 0===n||1!==n.length)throw new e.Error("date_modify filter expects 1 argument");var r,o=n[0];return e.lib.is("Date",t)&&(r=e.lib.strtotime(o,t.getTime()/1e3)),e.lib.is("String",t)&&(r=e.lib.strtotime(o,e.lib.strtotime(t))),e.lib.is("Number",t)&&(r=e.lib.strtotime(o,t)),new Date(1e3*r)}},replace:function(t,n){if(void 0!==t&&null!==t){var r,o=n[0];for(r in o)o.hasOwnProperty(r)&&"_keys"!==r&&(t=e.lib.replaceAll(t,r,o[r]));return t}},format:function(t,n){if(void 0!==t&&null!==t)return e.lib.vsprintf(t,n)},striptags:function(t){if(void 0!==t&&null!==t)return e.lib.strip_tags(t)},escape:function(t,n){if(void 0!==t&&null!==t){var r="html";if(n&&n.length&&n[0]!==!0&&(r=n[0]),"html"==r){var o=t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return e.Markup(o,"html")}if("js"==r){for(var o=t.toString(),i="",s=0;s<o.length;s++)if(o[s].match(/^[a-zA-Z0-9,\._]$/))i+=o[s];else{var a=o.charCodeAt(s);i+=a<128?"\\x"+a.toString(16).toUpperCase():e.lib.sprintf("\\u%04s",a.toString(16).toUpperCase())}return e.Markup(i,"js")}if("css"==r){for(var o=t.toString(),i="",s=0;s<o.length;s++)if(o[s].match(/^[a-zA-Z0-9]$/))i+=o[s];else{var a=o.charCodeAt(s);i+="\\"+a.toString(16).toUpperCase()+" "}return e.Markup(i,"css")}if("url"==r){var i=e.filters.url_encode(t);return e.Markup(i,"url")}if("html_attr"==r){for(var o=t.toString(),i="",s=0;s<o.length;s++)if(o[s].match(/^[a-zA-Z0-9,\.\-_]$/))i+=o[s];else if(o[s].match(/^[&<>"]$/))i+=o[s].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");else{var a=o.charCodeAt(s);i+=a<=31&&9!=a&&10!=a&&13!=a?"&#xFFFD;":a<128?e.lib.sprintf("&#x%02s;",a.toString(16).toUpperCase()):e.lib.sprintf("&#x%04s;",a.toString(16).toUpperCase())}return e.Markup(i,"html_attr")}throw new e.Error("escape strategy unsupported")}},e:function(t,n){return e.filters.escape(t,n)},nl2br:function(t){if(void 0!==t&&null!==t){var n="BACKSLASH_n_replace",r="<br />"+n;return t=e.filters.escape(t).replace(/\r\n/g,r).replace(/\r/g,r).replace(/\n/g,r),t=e.lib.replaceAll(t,n,"\n"),e.Markup(t)}},number_format:function(e,t){var n=e,r=t&&t[0]?t[0]:void 0,o=t&&void 0!==t[1]?t[1]:".",i=t&&void 0!==t[2]?t[2]:",";n=(n+"").replace(/[^0-9+\-Ee.]/g,"");var s=isFinite(+n)?+n:0,a=isFinite(+r)?Math.abs(r):0,p="",l=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return p=(a?l(s,a):""+Math.round(s)).split("."),p[0].length>3&&(p[0]=p[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(p[1]||"").length<a&&(p[1]=p[1]||"",p[1]+=new Array(a-p[1].length+1).join("0")),p.join(o)},trim:function(t,n){if(void 0!==t&&null!==t){var r,o=e.filters.escape(""+t);r=n&&n[0]?""+n[0]:" \n\r\t\f\x0B            ​\u2028\u2029　";for(var i=0;i<o.length;i++)if(r.indexOf(o.charAt(i))===-1){o=o.substring(i);break}for(i=o.length-1;i>=0;i--)if(r.indexOf(o.charAt(i))===-1){o=o.substring(0,i+1);break}return r.indexOf(o.charAt(0))===-1?o:""}},truncate:function(e,t){var n=30,r=!1,o="...";if(e+="",t&&(t[0]&&(n=t[0]),t[1]&&(r=t[1]),t[2]&&(o=t[2])),e.length>n){if(r&&(n=e.indexOf(" ",n),n===-1))return e;e=e.substr(0,n)+o}return e},slice:function(t,n){if(void 0!==t&&null!==t){if(void 0===n||n.length<1)throw new e.Error("slice filter expects at least 1 argument");var r=n[0]||0,o=n.length>1?n[1]:t.length,i=r>=0?r:Math.max(t.length+r,0);if(e.lib.is("Array",t)){for(var s=[],a=i;a<i+o&&a<t.length;a++)s.push(t[a]);return s}if(e.lib.is("String",t))return t.substr(i,o);throw new e.Error("slice filter expects value to be an array or string")}},abs:function(e){if(void 0!==e&&null!==e)return Math.abs(e)},first:function(e){if(t("Array",e))return e[0];if(t("Object",e)){if("_keys"in e)return e[e._keys[0]]}else if("string"==typeof e)return e.substr(0,1)},split:function(t,n){if(void 0!==t&&null!==t){if(void 0===n||n.length<1||n.length>2)throw new e.Error("split filter expects 1 or 2 argument");if(e.lib.is("String",t)){var r=n[0],o=n[1],i=t.split(r);if(void 0===o)return i;if(o<0)return t.split(r,i.length+o);var s=[];if(""==r)for(;i.length>0;){for(var a="",p=0;p<o&&i.length>0;p++)a+=i.shift();s.push(a)}else{for(var p=0;p<o-1&&i.length>0;p++)s.push(i.shift());i.length>0&&s.push(i.join(r))}return s}throw new e.Error("split filter expects value to be a string")}},last:function(t){if(e.lib.is("Object",t)){var n;return n=void 0===t._keys?Object.keys(t):t._keys,t[n[n.length-1]]}return t[t.length-1]},raw:function(t){return e.Markup(t)},batch:function(t,n){var r,o,i,s=n.shift(),a=n.shift();if(!e.lib.is("Array",t))throw new e.Error("batch filter expects items to be an array");if(!e.lib.is("Number",s))throw new e.Error("batch filter expects size to be a number");if(s=Math.ceil(s),r=e.lib.chunkArray(t,s),a&&t.length%s!=0){for(o=r.pop(),i=s-o.length;i--;)o.push(a);r.push(o)}return r},round:function(t,n){n=n||[];var r=n.length>0?n[0]:0,o=n.length>1?n[1]:"common";if(t=parseFloat(t),r&&!e.lib.is("Number",r))throw new e.Error("round filter expects precision to be a number");if("common"===o)return e.lib.round(t,r);if(!e.lib.is("Function",Math[o]))throw new e.Error("round filter expects method to be 'floor', 'ceil', or 'common'");return Math[o](t*Math.pow(10,r))/Math.pow(10,r)}},e.filter=function(t,n,r){if(!e.filters[t])throw"Unable to find filter "+t;return e.filters[t].apply(this,[n,r])},e.filter.extend=function(t,n){e.filters[t]=n},e}},function(e,t){e.exports=function(t){var n='Template "{name}" is not defined.';return t.functions={range:function(e,t,n){var r,o,i,s=[],a=n||1,p=!1;if(isNaN(e)||isNaN(t)?isNaN(e)&&isNaN(t)?(p=!0,r=e.charCodeAt(0),o=t.charCodeAt(0)):(r=isNaN(e)?0:e,o=isNaN(t)?0:t):(r=parseInt(e,10),o=parseInt(t,10)),i=!(r>o))for(;r<=o;)s.push(p?String.fromCharCode(r):r),r+=a;else for(;r>=o;)s.push(p?String.fromCharCode(r):r),r-=a;return s},cycle:function(e,t){var n=t%e.length;return e[n]},dump:function(){var e="\n",n="  ",r=0,o="",i=Array.prototype.slice.call(arguments),s=function(e){for(var t="";e>0;)e--,t+=n;return t},a=function(t){o+=s(r),"object"==typeof t?p(t):"function"==typeof t?o+="function()"+e:"string"==typeof t?o+="string("+t.length+') "'+t+'"'+e:"number"==typeof t?o+="number("+t+")"+e:"boolean"==typeof t&&(o+="bool("+t+")"+e)},p=function(t){var n;if(null===t)o+="NULL"+e;else if(void 0===t)o+="undefined"+e;else if("object"==typeof t){o+=s(r)+typeof t,r++,o+="("+function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(t)+") {"+e;for(n in t)o+=s(r)+"["+n+"]=> "+e,a(t[n]);r--,o+=s(r)+"}"+e}else a(t)};return 0==i.length&&i.push(this.context),t.forEach(i,function(e){p(e)}),o},date:function(e,n){var r;if(void 0===e||null===e||""===e)r=new Date;else if(t.lib.is("Date",e))r=e;else if(t.lib.is("String",e))r=e.match(/^[0-9]+$/)?new Date(1e3*e):new Date(1e3*t.lib.strtotime(e));else{if(!t.lib.is("Number",e))throw new t.Error("Unable to parse date "+e);r=new Date(1e3*e)}return r},block:function(e){return this.originalBlockTokens[e]?t.logic.parse.apply(this,[this.originalBlockTokens[e],this.context]).output:this.blocks[e]},parent:function(){return t.placeholders.parent},attribute:function(e,n,r){return t.lib.is("Object",e)&&e.hasOwnProperty(n)?"function"==typeof e[n]?e[n].apply(void 0,r):e[n]:e[n]||void 0},max:function(e){return t.lib.is("Object",e)?(delete e._keys,t.lib.max(e)):t.lib.max.apply(null,arguments)},min:function(e){return t.lib.is("Object",e)?(delete e._keys,t.lib.min(e)):t.lib.min.apply(null,arguments)},template_from_string:function(e){return void 0===e&&(e=""),t.Templates.parsers.twig({options:this.options,data:e})},random:function(e){function n(e){var t=Math.floor(Math.random()*r),n=[0,e],o=Math.min.apply(null,n),i=Math.max.apply(null,n);return o+Math.floor((i-o+1)*t/r)}var r=2147483648;if(t.lib.is("Number",e))return n(e);if(t.lib.is("String",e))return e.charAt(n(e.length-1));if(t.lib.is("Array",e))return e[n(e.length-1)];if(t.lib.is("Object",e)){var o=Object.keys(e);return e[o[n(o.length-1)]]}return n(r-1)},source:function(r,o){var i,s,a,p=!1,l="undefined"!=typeof e&&"undefined"!=typeof e.exports&&"undefined"==typeof window;l?(s="fs",a=__dirname+"/"+r):(s="ajax",a=r);var c={id:r,path:a,method:s,parser:"source",async:!1,fetchTemplateSource:!0};"undefined"==typeof o&&(o=!1);try{i=t.Templates.loadRemote(r,c),"undefined"==typeof i||null===i?i="":p=!0}catch(u){t.log.debug("Twig.functions.source: ","Problem loading template  ",u)}return p||o?i:n.replace("{name}",r)}},t._function=function(e,n,r){if(!t.functions[e])throw"Unable to find function "+e;return t.functions[e](n,r)},t._function.extend=function(e,n){t.functions[e]=n},t}},function(e,t,n){e.exports=function(e){return e.lib={},e.lib.sprintf=n(8),e.lib.vsprintf=n(9),e.lib.round=n(10),e.lib.max=n(11),e.lib.min=n(12),e.lib.strip_tags=n(13),e.lib.strtotime=n(14),e.lib.date=n(15),e.lib.boolval=n(16),e.lib.is=function(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return void 0!==t&&null!==t&&n===e},e.lib.copy=function(e){var t,n={};for(t in e)n[t]=e[t];return n},e.lib.extend=function(e,t){var n,r=Object.keys(t);for(n=r.length;n--;)e[r[n]]=t[r[n]];return e},e.lib.replaceAll=function(e,t,n){return e.split(t).join(n)},e.lib.chunkArray=function(t,n){var r=[],o=0,i=t.length;if(n<1||!e.lib.is("Array",t))return[];for(;o<i;)r.push(t.slice(o,o+=n));return r},e}},function(e,t){"use strict";e.exports=function(){var e=/%%|%(\d+\$)?([-+'#0 ]*)(\*\d+\$|\*|\d+)?(?:\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,n=0,r=t[n++],o=function(e,t,n,r){n||(n=" ");var o=e.length>=t?"":new Array(1+t-e.length>>>0).join(n);return r?e+o:o+e},i=function(e,t,n,r,i,s){var a=r-e.length;return a>0&&(e=n||!i?o(e,r,s,n):[e.slice(0,t.length),o("",a,"0",!0),e.slice(t.length)].join("")),e},s=function(e,t,n,r,s,a,p){var l=e>>>0;return n=n&&l&&{2:"0b",8:"0",16:"0x"}[t]||"",e=n+o(l.toString(t),a||0,"0",!1),i(e,n,r,s,p)},a=function(e,t,n,r,o,s){return null!==r&&void 0!==r&&(e=e.slice(0,r)),i(e,"",t,n,o,s)},p=function(e,r,p,l,c,u){var f,d,h,g,y;if("%%"===e)return"%";var m,v=!1,w="",x=!1,b=!1,k=" ",T=p.length;for(m=0;m<T;m++)switch(p.charAt(m)){case" ":w=" ";break;case"+":w="+";break;case"-":v=!0;break;case"'":k=p.charAt(m+1);break;case"0":x=!0,k="0";break;case"#":b=!0}if(l=l?"*"===l?+t[n++]:"*"===l.charAt(0)?+t[l.slice(1,-1)]:+l:0,l<0&&(l=-l,v=!0),!isFinite(l))throw new Error("sprintf: (minimum-)width must be finite");switch(c=c?"*"===c?+t[n++]:"*"===c.charAt(0)?+t[c.slice(1,-1)]:+c:"fFeE".indexOf(u)>-1?6:"d"===u?0:void 0,y=r?t[r.slice(0,-1)]:t[n++],u){case"s":return a(y+"",v,l,c,x,k);case"c":return a(String.fromCharCode(+y),v,l,c,x);case"b":return s(y,2,b,v,l,c,x);case"o":return s(y,8,b,v,l,c,x);case"x":return s(y,16,b,v,l,c,x);case"X":return s(y,16,b,v,l,c,x).toUpperCase();case"u":return s(y,10,b,v,l,c,x);case"i":case"d":return f=+y||0,f=Math.round(f-f%1),d=f<0?"-":w,y=d+o(String(Math.abs(f)),c,"0",!1),i(y,d,v,l,x);case"e":case"E":case"f":case"F":case"g":case"G":return f=+y,d=f<0?"-":w,h=["toExponential","toFixed","toPrecision"]["efg".indexOf(u.toLowerCase())],g=["toString","toUpperCase"]["eEfFgG".indexOf(u)%2],y=d+Math.abs(f)[h](c),i(y,d,v,l,x)[g]();default:return e}};return r.replace(e,p)}},function(e,t,n){"use strict";e.exports=function(e,t){var r=n(8);return r.apply(this,[e].concat(t))}},function(e,t){"use strict";e.exports=function(e,t,n){var r,o,i,s;if(t|=0,r=Math.pow(10,t),e*=r,s=e>0|-(e<0),i=e%1===.5*s,o=Math.floor(e),i)switch(n){case"PHP_ROUND_HALF_DOWN":e=o+(s<0);break;case"PHP_ROUND_HALF_EVEN":e=o+o%2*s;break;case"PHP_ROUND_HALF_ODD":e=o+!(o%2);break;default:e=o+(s>0)}return(i?e:Math.round(e))/r}},function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(){var e,t,r=0,o=0,i=arguments,s=i.length,a=function(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},p=function l(e,t){var r=0,o=0,i=0,s=0,p=0;if(e===t)return 0;if("object"===("undefined"==typeof e?"undefined":n(e))){if("object"===("undefined"==typeof t?"undefined":n(t))){if(e=a(e),t=a(t),p=e.length,s=t.length,s>p)return 1;if(s<p)return-1;for(r=0,o=p;r<o;++r){if(i=l(e[r],t[r]),1===i)return 1;if(i===-1)return-1}return 0}return-1}return"object"===("undefined"==typeof t?"undefined":n(t))?1:isNaN(t)&&!isNaN(e)?0===e?0:e<0?1:-1:isNaN(e)&&!isNaN(t)?0===t?0:t>0?1:-1:t===e?0:t>e?1:-1};if(0===s)throw new Error("At least one value should be passed to max()");if(1===s){if("object"!==n(i[0]))throw new Error("Wrong parameter count for max()");if(e=a(i[0]),0===e.length)throw new Error("Array must contain at least one element for max()")}else e=i;for(t=e[0],r=1,o=e.length;r<o;++r)1===p(t,e[r])&&(t=e[r]);return t}},function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(){var e,t,r=0,o=0,i=arguments,s=i.length,a=function(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},p=function l(e,t){var r=0,o=0,i=0,s=0,p=0;if(e===t)return 0;if("object"===("undefined"==typeof e?"undefined":n(e))){if("object"===("undefined"==typeof t?"undefined":n(t))){if(e=a(e),t=a(t),p=e.length,s=t.length,s>p)return 1;if(s<p)return-1;for(r=0,o=p;r<o;++r){if(i=l(e[r],t[r]),1===i)return 1;if(i===-1)return-1}return 0}return-1}return"object"===("undefined"==typeof t?"undefined":n(t))?1:isNaN(t)&&!isNaN(e)?0===e?0:e<0?1:-1:isNaN(e)&&!isNaN(t)?0===t?0:t>0?1:-1:t===e?0:t>e?1:-1};if(0===s)throw new Error("At least one value should be passed to min()");if(1===s){if("object"!==n(i[0]))throw new Error("Wrong parameter count for min()");if(e=a(i[0]),0===e.length)throw new Error("Array must contain at least one element for min()")}else e=i;for(t=e[0],r=1,o=e.length;r<o;++r)p(t,e[r])===-1&&(t=e[r]);return t}},function(e,t){"use strict";e.exports=function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,r=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(r,"").replace(n,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})}},function(e,t){"use strict";e.exports=function(e,t){function n(e,t,n){var r,o=l[t];"undefined"!=typeof o&&(r=o-p.getDay(),0===r?r=7*n:r>0&&"last"===e?r-=7:r<0&&"next"===e&&(r+=7),p.setDate(p.getDate()+r))}function r(e){var t=e.split(" "),r=t[0],o=t[1].substring(0,3),i=/\d+/.test(r),s="ago"===t[2],a=("last"===r?-1:1)*(s?-1:1);if(i&&(a*=parseInt(r,10)),c.hasOwnProperty(o)&&!t[1].match(/^mon(day|\.)?$/i))return p["set"+c[o]](p["get"+c[o]]()+a);if("wee"===o)return p.setDate(p.getDate()+7*a);if("next"===r||"last"===r)n(r,o,a);else if(!i)return!1;return!0}var o,i,s,a,p,l,c,u,f,d,h,g=!1;if(!e)return g;e=e.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();var y=new RegExp(["^(\\d{1,4})","([\\-\\.\\/:])","(\\d{1,2})","([\\-\\.\\/:])","(\\d{1,4})","(?:\\s(\\d{1,2}):(\\d{2})?:?(\\d{2})?)?","(?:\\s([A-Z]+)?)?$"].join(""));if(i=e.match(y),i&&i[2]===i[4])if(i[1]>1901)switch(i[2]){case"-":return i[3]>12||i[5]>31?g:new Date(i[1],parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case".":return g;case"/":return i[3]>12||i[5]>31?g:new Date(i[1],parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3}else if(i[5]>1901)switch(i[2]){case"-":return i[3]>12||i[1]>31?g:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case".":return i[3]>12||i[1]>31?g:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case"/":return i[1]>12||i[3]>31?g:new Date(i[5],parseInt(i[1],10)-1,i[3],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3}else switch(i[2]){case"-":return i[3]>12||i[5]>31||i[1]<70&&i[1]>38?g:(a=i[1]>=0&&i[1]<=38?+i[1]+2e3:i[1],new Date(a,parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3);case".":return i[5]>=70?i[3]>12||i[1]>31?g:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3:i[5]<60&&!i[6]?i[1]>23||i[3]>59?g:(s=new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate(),i[1]||0,i[3]||0,i[5]||0,i[9]||0)/1e3):g;case"/":return i[1]>12||i[3]>31||i[5]<70&&i[5]>38?g:(a=i[5]>=0&&i[5]<=38?+i[5]+2e3:i[5],new Date(a,parseInt(i[1],10)-1,i[3],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3);case":":return i[1]>23||i[3]>59||i[5]>59?g:(s=new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate(),i[1]||0,i[3]||0,i[5]||0)/1e3)}if("now"===e)return null===t||isNaN(t)?(new Date).getTime()/1e3|0:0|t;if(!isNaN(o=Date.parse(e)))return o/1e3|0;if(y=new RegExp(["^([0-9]{4}-[0-9]{2}-[0-9]{2})","[ t]","([0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?)","([\\+-][0-9]{2}(:[0-9]{2})?|z)"].join("")),i=e.match(y),i&&("z"===i[4]?i[4]="Z":i[4].match(/^([+-][0-9]{2})$/)&&(i[4]=i[4]+":00"),!isNaN(o=Date.parse(i[1]+"T"+i[2]+i[4]))))return o/1e3|0;if(p=t?new Date(1e3*t):new Date,l={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},c={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"},f="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)",d="([+-]?\\d+\\s"+f+"|(last|next)\\s"+f+")(\\sago)?",i=e.match(new RegExp(d,"gi")),!i)return g;for(h=0,u=i.length;h<u;h++)if(!r(i[h]))return g;return p.getTime()/1e3}},function(e,t){"use strict";e.exports=function(e,t){var n,r,o=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],i=/\\?(.?)/gi,s=function(e,t){return r[e]?r[e]():t},a=function(e,t){for(e=String(e);e.length<t;)e="0"+e;return e};r={d:function(){return a(r.j(),2)},D:function(){return r.l().slice(0,3)},j:function(){return n.getDate()},l:function(){return o[r.w()]+"day"},N:function(){return r.w()||7},S:function(){var e=r.j(),t=e%10;return t<=3&&1===parseInt(e%100/10,10)&&(t=0),["st","nd","rd"][t-1]||"th"},w:function(){return n.getDay()},z:function(){var e=new Date(r.Y(),r.n()-1,r.j()),t=new Date(r.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){var e=new Date(r.Y(),r.n()-1,r.j()-r.N()+3),t=new Date(e.getFullYear(),0,4);return a(1+Math.round((e-t)/864e5/7),2)},F:function(){return o[6+r.n()]},m:function(){return a(r.n(),2)},M:function(){return r.F().slice(0,3)},n:function(){return n.getMonth()+1},t:function(){return new Date(r.Y(),r.n(),0).getDate()},L:function(){var e=r.Y();return e%4===0&e%100!==0|e%400===0},o:function(){var e=r.n(),t=r.W(),n=r.Y();return n+(12===e&&t<9?1:1===e&&t>9?-1:0)},Y:function(){return n.getFullYear()},y:function(){return r.Y().toString().slice(-2)},a:function(){return n.getHours()>11?"pm":"am"},A:function(){return r.a().toUpperCase()},B:function(){var e=3600*n.getUTCHours(),t=60*n.getUTCMinutes(),r=n.getUTCSeconds();return a(Math.floor((e+t+r+3600)/86.4)%1e3,3)},g:function(){return r.G()%12||12},G:function(){return n.getHours()},h:function(){return a(r.g(),2)},H:function(){return a(r.G(),2)},i:function(){return a(n.getMinutes(),2)},s:function(){return a(n.getSeconds(),2)},u:function(){return a(1e3*n.getMilliseconds(),6)},e:function(){var e="Not supported (see source code of date() for timezone on how to add support)";throw new Error(e)},I:function(){var e=new Date(r.Y(),0),t=Date.UTC(r.Y(),0),n=new Date(r.Y(),6),o=Date.UTC(r.Y(),6);return e-t!==n-o?1:0},O:function(){var e=n.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+a(100*Math.floor(t/60)+t%60,4)},P:function(){var e=r.O();return e.substr(0,3)+":"+e.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-n.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(i,s)},r:function(){return"D, d M Y H:i:s O".replace(i,s)},U:function(){return n/1e3|0}};var p=function(e,t){return n=void 0===t?new Date:t instanceof Date?new Date(t):new Date(1e3*t),e.replace(i,s)};return p(e,t)}},function(e,t){"use strict";e.exports=function(e){return e!==!1&&(0!==e&&0!==e&&(""!==e&&"0"!==e&&((!Array.isArray(e)||0!==e.length)&&(null!==e&&void 0!==e))))}},function(e,t){e.exports=function(e){"use strict";e.Templates.registerLoader("ajax",function(t,n,r,o){var i,s,a=n.precompiled,p=this.parsers[n.parser]||this.parser.twig;if("undefined"==typeof XMLHttpRequest)throw new e.Error('Unsupported platform: Unable to do ajax requests because there is no "XMLHTTPRequest" implementation');return s=new XMLHttpRequest,s.onreadystatechange=function(){var l=null;4===s.readyState&&(200===s.status||window.cordova&&0==s.status?(e.log.debug("Got template ",s.responseText),l=a===!0?JSON.parse(s.responseText):s.responseText,n.url=t,n.data=l,i=p.call(this,n),"function"==typeof r&&r(i)):"function"==typeof o&&o(s))},s.open("GET",t,!!n.async),s.send(),!!n.async||i})}},function(e,t,n){e.exports=function(e){"use strict";var t,r;try{t=n(19),r=n(20)}catch(o){}e.Templates.registerLoader("fs",function(n,o,i,s){var a,p=null,l=o.precompiled,c=this.parsers[o.parser]||this.parser.twig;if(!t||!r)throw new e.Error('Unsupported platform: Unable to load from file because there is no "fs" or "path" implementation');var u=function(e,t){return e?void("function"==typeof s&&s(e)):(l===!0&&(t=JSON.parse(t)),o.data=t,o.path=o.path||n,a=c.call(this,o),void("function"==typeof i&&i(a)))};if(o.path=o.path||n,o.async)return t.stat(o.path,function(n,r){return n||!r.isFile()?void("function"==typeof s&&s(new e.Error("Unable to find template file "+o.path))):void t.readFile(o.path,"utf8",u)}),!0;try{if(!t.statSync(o.path).isFile())throw new e.Error("Unable to find template file "+o.path)}catch(f){throw new e.Error("Unable to find template file "+o.path)}return p=t.readFileSync(o.path,"utf8"),u(void 0,p),a})}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e,t){e.exports=function(e){"use strict";for(e.logic={},e.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",shortblock:"Twig.logic.type.shortblock",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from",embed:"Twig.logic.type.embed",endembed:"Twig.logic.type.endembed"},e.logic.definitions=[{type:e.logic.type.if_,
regex:/^if\s+([\s\S]+)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!0,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var o=this;return e.expression.parseAsync.apply(this,[t.stack,n]).then(function(i){return r=!0,e.lib.boolval(i)?(r=!1,e.parseAsync.apply(o,[t.output,n])):""}).then(function(e){return{chain:r,output:e}})}},{type:e.logic.type.elseif,regex:/^elseif\s+([^\s].*)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!1,compile:function(t){var n=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){var o=this;return e.expression.parseAsync.apply(this,[t.stack,n]).then(function(i){return r&&e.lib.boolval(i)?(r=!1,e.parseAsync.apply(o,[t.output,n])):""}).then(function(e){return{chain:r,output:e}})}},{type:e.logic.type.else_,regex:/^else$/,next:[e.logic.type.endif,e.logic.type.endfor],open:!1,parse:function(t,n,r){var o=e.Promise.resolve("");return r&&(o=e.parseAsync.apply(this,[t.output,n])),o.then(function(e){return{chain:r,output:e}})}},{type:e.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:e.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([^\s].*?)(?:\s+if\s+([^\s].*))?$/,next:[e.logic.type.else_,e.logic.type.endfor],open:!0,compile:function(t){var n=t.match[1],r=t.match[2],o=t.match[3],i=null;if(t.key_var=null,t.value_var=null,n.indexOf(",")>=0){if(i=n.split(","),2!==i.length)throw new e.Error("Invalid expression in for loop: "+n);t.key_var=i[0].trim(),t.value_var=i[1].trim()}else t.value_var=n;return t.expression=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,o&&(t.conditional=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:o}]).stack),delete t.match,t},parse:function(t,n,r){var o,i,s=[],a=0,p=this,l=t.conditional,c=function(e,t){var r=void 0!==l;return{index:e+1,index0:e,revindex:r?void 0:t-e,revindex0:r?void 0:t-e-1,first:0===e,last:r?void 0:e===t-1,length:r?void 0:t,parent:n}},u=function(r,i){var u=e.ChildContext(n);u[t.value_var]=i,t.key_var&&(u[t.key_var]=r),u.loop=c(a,o);var f=void 0===l?e.Promise.resolve(!0):e.expression.parseAsync.apply(p,[l,u]);f.then(function(n){if(n)return e.parseAsync.apply(p,[t.output,u]).then(function(e){s.push(e),a+=1})}).then(function(){delete u.loop,delete u[t.value_var],delete u[t.key_var],e.merge(n,u,!0)})};return e.expression.parseAsync.apply(this,[t.expression,n]).then(function(t){return e.lib.is("Array",t)?(o=t.length,e.async.forEach(t,function(e){var t=a;return u(t,e)})):e.lib.is("Object",t)&&(i=void 0!==t._keys?t._keys:Object.keys(t),o=i.length,e.forEach(i,function(e){"_keys"!==e&&u(e,t[e])})),r=0===s.length,{chain:r,output:e.output.apply(p,[s])}})}},{type:e.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:e.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*([\s\S]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2],o=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack;return t.key=n,t.expression=o,delete t.match,t},parse:function(t,n,r){var o=t.key;return e.expression.parseAsync.apply(this,[t.expression,n]).then(function(t){return t===n&&(t=e.lib.copy(t)),n[o]=t,{chain:r,context:n}})}},{type:e.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[e.logic.type.endset],open:!0,compile:function(e){var t=e.match[1].trim();return e.key=t,delete e.match,e},parse:function(t,n,r){var o=this,i=t.key;return e.parseAsync.apply(this,[t.output,n]).then(function(e){return o.context[i]=e,n[i]=e,{chain:r,context:n}})}},{type:e.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:e.logic.type.filter,regex:/^filter\s+(.+)$/,next:[e.logic.type.endfilter],open:!0,compile:function(t){var n="|"+t.match[1].trim();return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,delete t.match,t},parse:function(t,n,r){return e.parseAsync.apply(this,[t.output,n]).then(function(r){var o=[{type:e.expression.type.string,value:r}].concat(t.stack);return e.expression.parseAsync.apply(that,[o,n])}).then(function(e){return{chain:r,output:e}})}},{type:e.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:e.logic.type.block,regex:/^block\s+([a-zA-Z0-9_]+)$/,next:[e.logic.type.endblock],open:!0,compile:function(e){return e.block=e.match[1].trim(),delete e.match,e},parse:function(t,n,r){var o,i=this,s=e.Promise.resolve(),a=e.indexOf(this.importedBlocks,t.block)>-1,p=this.blocks[t.block]&&e.indexOf(this.blocks[t.block],e.placeholders.parent)>-1;return(void 0===this.blocks[t.block]||a||p||n.loop||t.overwrite)&&(s=t.expression?e.expression.parseAsync.apply(this,[t.output,n]).then(function(t){return e.expression.parseAsync.apply(i,[{type:e.expression.type.string,value:t},n])}):e.parseAsync.apply(this,[t.output,n]).then(function(t){return e.expression.parseAsync.apply(i,[{type:e.expression.type.string,value:t},n])}),s=s.then(function(n){a&&i.importedBlocks.splice(i.importedBlocks.indexOf(t.block),1),p?i.blocks[t.block]=e.Markup(i.blocks[t.block].replace(e.placeholders.parent,n)):i.blocks[t.block]=n,i.originalBlockTokens[t.block]={type:t.type,block:t.block,output:t.output,overwrite:!0}})),s.then(function(){return o=i.child.blocks[t.block]?i.child.blocks[t.block]:i.blocks[t.block],{chain:r,output:o}})}},{type:e.logic.type.shortblock,regex:/^block\s+([a-zA-Z0-9_]+)\s+(.+)$/,next:[],open:!0,compile:function(t){return t.expression=t.match[2].trim(),t.output=e.expression.compile({type:e.expression.type.expression,value:t.expression}).stack,t.block=t.match[1].trim(),delete t.match,t},parse:function(t,n,r){return e.logic.handler[e.logic.type.block].parse.apply(this,arguments)}},{type:e.logic.type.endblock,regex:/^endblock(?:\s+([a-zA-Z0-9_]+))?$/,next:[],open:!1},{type:e.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var o,i=this,s=e.ChildContext(n);return e.expression.parseAsync.apply(this,[t.stack,n]).then(function(t){return i.extend=t,o=t instanceof e.Template?t:i.importFile(t),o.renderAsync(s)}).then(function(){return e.lib.extend(n,s),{chain:r,output:""}})}},{type:e.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var o=this;return e.expression.parseAsync.apply(this,[t.stack,n]).then(function(e){return o.importBlocks(e),{chain:r,output:""}})}},{type:e.logic.type.include,regex:/^include\s+(.+?)(?:\s|$)(ignore missing(?:\s|$))?(?:with\s+([\S\s]+?))?(?:\s|$)(only)?$/,next:[],open:!0,compile:function(t){var n=t.match,r=n[1].trim(),o=void 0!==n[2],i=n[3],s=void 0!==n[4]&&n[4].length;return delete t.match,t.only=s,t.ignoreMissing=o,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,void 0!==i&&(t.withStack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i.trim()}]).stack),t},parse:function(t,n,r){var o,i,s={},a=this,p=e.Promise.resolve();return t.only||(s=e.ChildContext(n)),void 0!==t.withStack&&(p=e.expression.parseAsync.apply(this,[t.withStack,n]).then(function(e){for(o in e)e.hasOwnProperty(o)&&(s[o]=e[o])})),p.then(function(){return e.expression.parseAsync.apply(a,[t.stack,n])}).then(function(n){if(n instanceof e.Template)i=n;else try{i=a.importFile(n)}catch(r){if(t.ignoreMissing)return"";throw r}return i.renderAsync(s)}).then(function(e){return{chain:r,output:e}})}},{type:e.logic.type.spaceless,regex:/^spaceless$/,next:[e.logic.type.endspaceless],open:!0,parse:function(t,n,r){return e.parseAsync.apply(this,[t.output,n]).then(function(t){var n=/>\s+</g,o=t.replace(n,"><").trim();return o=e.Markup(o),{chain:r,output:o}})}},{type:e.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:e.logic.type.macro,regex:/^macro\s+([a-zA-Z0-9_]+)\s*\(\s*((?:[a-zA-Z0-9_]+(?:,\s*)?)*)\s*\)$/,next:[e.logic.type.endmacro],open:!0,compile:function(t){for(var n=t.match[1],r=t.match[2].split(/[\s,]+/),o=0;o<r.length;o++)for(var i=0;i<r.length;i++)if(r[o]===r[i]&&o!==i)throw new e.Error("Duplicate arguments for parameter: "+r[o]);return t.macroName=n,t.parameters=r,delete t.match,t},parse:function(t,n,r){var o=this;return this.macros[t.macroName]=function(){for(var n={_self:o.macros},r=0;r<t.parameters.length;r++){var i=t.parameters[r];"undefined"!=typeof arguments[r]?n[i]=arguments[r]:n[i]=void 0}return e.parseAsync.apply(o,[t.output,n])},{chain:r,output:""}}},{type:e.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:e.logic.type.import_,regex:/^import\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/,next:[],open:!0,compile:function(t){var n=t.match[1].trim(),r=t.match[2].trim();return delete t.match,t.expression=n,t.contextName=r,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var o=this,i={chain:r,output:""};return"_self"===t.expression?(n[t.contextName]=this.macros,e.Promise.resolve(i)):e.expression.parseAsync.apply(this,[t.stack,n]).then(function(e){return o.importFile(e||t.expression)}).then(function(e){return n[t.contextName]=e.renderAsync({},{output:"macros"}),i})}},{type:e.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(t){for(var n=t.match[1].trim(),r=t.match[2].trim().split(/\s*,\s*/),o={},i=0;i<r.length;i++){var s=r[i],a=s.match(/^([a-zA-Z0-9_]+)\s+as\s+([a-zA-Z0-9_]+)$/);a?o[a[1].trim()]=a[2].trim():s.match(/^([a-zA-Z0-9_]+)$/)&&(o[s]=s)}return delete t.match,t.expression=n,t.macroNames=o,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,t},parse:function(t,n,r){var o=this,i=e.Promise.resolve(this.macros);return"_self"!==t.expression&&(i=e.expression.parseAsync.apply(this,[t.stack,n]).then(function(e){return o.importFile(e||t.expression)}).then(function(e){return e.renderAsync({},{output:"macros"})})),i.then(function(e){for(var o in t.macroNames)e.hasOwnProperty(o)&&(n[t.macroNames[o]]=e[o]);return{chain:r,output:""}})}},{type:e.logic.type.embed,regex:/^embed\s+(.+?)(?:\s|$)(ignore missing(?:\s|$))?(?:with\s+([\S\s]+?))?(?:\s|$)(only)?$/,next:[e.logic.type.endembed],open:!0,compile:function(t){var n=t.match,r=n[1].trim(),o=void 0!==n[2],i=n[3],s=void 0!==n[4]&&n[4].length;return delete t.match,t.only=s,t.ignoreMissing=o,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,void 0!==i&&(t.withStack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i.trim()}]).stack),t},parse:function(t,n,r){var o,i,s={},a=this,p=e.Promise.resolve();if(!t.only)for(o in n)n.hasOwnProperty(o)&&(s[o]=n[o]);return void 0!==t.withStack&&(p=e.expression.parseAsync.apply(this,[t.withStack,n]).then(function(e){for(o in e)e.hasOwnProperty(o)&&(s[o]=e[o])})),p.then(function(){return e.expression.parseAsync.apply(a,[t.stack,s])}).then(function(n){if(n instanceof e.Template)i=n;else try{i=a.importFile(n)}catch(r){if(t.ignoreMissing)return"";throw r}return a.blocks={},e.parseAsync.apply(a,[t.output,s]).then(function(){return i.renderAsync(s,{blocks:a.blocks})})}).then(function(e){return{chain:r,output:e}})}},{type:e.logic.type.endembed,regex:/^endembed$/,next:[],open:!1}],e.logic.handler={},e.logic.extendType=function(t,n){n=n||"Twig.logic.type"+t,e.logic.type[t]=n},e.logic.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);e.logic.extendType(t.type),e.logic.handler[t.type]=t};e.logic.definitions.length>0;)e.logic.extend(e.logic.definitions.shift());return e.logic.compile=function(t){var n=t.value.trim(),r=e.logic.tokenize.apply(this,[n]),o=e.logic.handler[r.type];return o.compile&&(r=o.compile.apply(this,[r]),e.log.trace("Twig.logic.compile: ","Compiled logic token to ",r)),r},e.logic.tokenize=function(t){var n={},r=null,o=null,i=null,s=null,a=null,p=null;t=t.trim();for(r in e.logic.handler)if(e.logic.handler.hasOwnProperty(r))for(o=e.logic.handler[r].type,i=e.logic.handler[r].regex,s=[],i instanceof Array?s=i:s.push(i);s.length>0;)if(a=s.shift(),p=a.exec(t.trim()),null!==p)return n.type=o,n.match=p,e.log.trace("Twig.logic.tokenize: ","Matched a ",o," regular expression of ",p),n;throw new e.Error("Unable to parse '"+t.trim()+"'")},e.logic.parse=function(t,n,r,o){var i,s,a="",p=!0;if(n=n||{},e.log.debug("Twig.logic.parse: ","Parsing logic token ",t),s=e.logic.handler[t.type],s.parse&&(a=s.parse.apply(this,[t,n,r])),i=e.isPromise(a)?a:e.Promise.resolve(a),i.then(function(e){p=!1,a=e}),o)return i||e.Promise.resolve(a);if(p)throw new e.Error("You are using Twig.js in sync mode in combination with async extensions.");return a},e}},function(e,t){e.exports=function(e){"use strict";e.Templates.registerParser("source",function(e){return e.data||""})}},function(e,t){e.exports=function(e){"use strict";e.Templates.registerParser("twig",function(t){return new e.Template(t)})}},function(e,t,n){e.exports=function(e){"use strict";return e.path={},e.path.parsePath=function(t,n){var r=null,n=n||"";if("object"==typeof t&&"object"==typeof t.options&&(r=t.options.namespaces),"object"==typeof r&&n.indexOf("::")>0||n.indexOf("@")>=0){for(var o in r)r.hasOwnProperty(o)&&(n=n.replace(o+"::",r[o]),n=n.replace("@"+o,r[o]));return n}return e.path.relativePath(t,n)},e.path.relativePath=function(t,r){var o,i,s,a="/",p=[],r=r||"";if(t.url)o="undefined"!=typeof t.base?t.base+("/"===t.base.charAt(t.base.length-1)?"":"/"):t.url;else if(t.path){var l=n(20),c=l.sep||a,u=new RegExp("^\\.{1,2}"+c.replace("\\","\\\\"));r=r.replace(/\//g,c),void 0!==t.base&&null==r.match(u)?(r=r.replace(t.base,""),o=t.base+c):o=l.normalize(t.path),o=o.replace(c+c,c),a=c}else{if(!t.name&&!t.id||!t.method||"fs"===t.method||"ajax"===t.method)throw new e.Error("Cannot extend an inline template.");o=t.base||t.name||t.id}for(i=o.split(a),i.pop(),i=i.concat(r.split(a));i.length>0;)s=i.shift(),"."==s||(".."==s&&p.length>0&&".."!=p[p.length-1]?p.pop():p.push(s));return p.join(a)},e}},function(e,t){e.exports=function(e){"use strict";return e.tests={empty:function(e){if(null===e||void 0===e)return!0;if("number"==typeof e)return!1;if(e.length&&e.length>0)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},odd:function(e){return e%2===1},even:function(e){return e%2===0},divisibleby:function(e,t){return e%t[0]===0},defined:function(e){return void 0!==e},none:function(e){return null===e},"null":function(e){return this.none(e)},"same as":function(e,t){return e===t[0]},sameas:function(t,n){return console.warn("`sameas` is deprecated use `same as`"),e.tests["same as"](t,n)},iterable:function(t){return t&&(e.lib.is("Array",t)||e.lib.is("Object",t))}},e.test=function(t,n,r){if(!e.tests[t])throw"Test "+t+" is not defined.";return e.tests[t](n,r)},e.test.extend=function(t,n){e.tests[t]=n},e}},function(e,t){e.exports=function(e){"use strict";return e.parseAsync=function(t,n){return e.parse.apply(this,[t,n,!0])},e.expression.parseAsync=function(t,n,r){return e.expression.parse.apply(this,[t,n,r,!0])},e.logic.parseAsync=function(t,n,r){return e.logic.parse.apply(this,[t,n,r,!0])},e.Template.prototype.renderAsync=function(e,t){return this.render(e,t,!0)},e.async={},e.isPromise=function(e){return e&&"function"==typeof e.then},e.Promise=function(t){function n(e,t){l=e,c=t,i()}function r(e){n("resolve",e)}function o(e){n("reject",e)}function i(){u&&(e.forEach(u,function(e){s(e.resolve,e.reject)}),u=null)}function s(e,t){var n={resolve:e,reject:t};return"unknown"==l?(u=u||[],u.push(n)):void(n[l]&&n[l](c))}function a(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(o){r=!0,n(o)}}function p(t){try{if(!e.isPromise(t))return r(t);a(t.then.bind(t),p,o)}catch(n){o(n)}}var l="unknown",c=null,u=null;return a(t,p,o),{then:function(t,n){var r="function"==typeof t,o="function"==typeof n;return new e.Promise(function(e,i){s(function(n){if(r)try{e(t(n))}catch(o){i(o)}else e(n)},function(t){if(o)try{e(n(t))}catch(r){i(r)}else i(t)})})},"catch":function(e){return this.then(null,e)}}},e.Promise.resolve=function(t){return new e.Promise(function(e){e(t)})},e.Promise.reject=function(t){return new e.Promise(function(e,n){n(t)})},e.Promise.all=function(t){var n=[];return e.async.forEach(t,function(t,r){return e.isPromise(t)?t.then(function(e){n[r]=e}):void(n[r]=t)}).then(function(){return n})},e.async.forEach=function(t,n){function r(e){a.reject(e)}function o(t){return e.isPromise(t)?void t.then(o,r):i()}function i(){var e=s++;return e==t.length?void a.resolve():void o(n(t[e],e))}var s=0,a={},p=new e.Promise(function(e,t){a={resolve:e,reject:t}});return i(),p},e}},function(e,t){e.exports=function(e){"use strict";return e.exports={VERSION:e.VERSION},e.exports.twig=function(t){var n=t.id,r={strict_variables:t.strict_variables||!1,autoescape:null!=t.autoescape&&t.autoescape||!1,allowInlineIncludes:t.allowInlineIncludes||!1,rethrow:t.rethrow||!1,namespaces:t.namespaces};if(e.cache&&n&&e.validateId(n),void 0!==t.debug&&(e.debug=t.debug),void 0!==t.trace&&(e.trace=t.trace),void 0!==t.data)return e.Templates.parsers.twig({data:t.data,path:t.hasOwnProperty("path")?t.path:void 0,module:t.module,id:n,options:r});if(void 0!==t.ref){if(void 0!==t.id)throw new e.Error("Both ref and id cannot be set on a twig.js template.");return e.Templates.load(t.ref)}if(void 0!==t.method){if(!e.Templates.isRegisteredLoader(t.method))throw new e.Error('Loader for "'+t.method+'" is not defined.');return e.Templates.loadRemote(t.name||t.href||t.path||n||void 0,{id:n,method:t.method,parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:r},t.load,t.error)}return void 0!==t.href?e.Templates.loadRemote(t.href,{id:n,method:"ajax",parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:r},t.load,t.error):void 0!==t.path?e.Templates.loadRemote(t.path,{id:n,method:"fs",parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:r},t.load,t.error):void 0},e.exports.extendFilter=function(t,n){e.filter.extend(t,n)},e.exports.extendFunction=function(t,n){e._function.extend(t,n)},e.exports.extendTest=function(t,n){e.test.extend(t,n)},e.exports.extendTag=function(t){e.logic.extend(t)},e.exports.extend=function(t){t(e)},e.exports.compile=function(t,n){var r,o=n.filename,i=n.filename;return r=new e.Template({data:t,path:i,id:o,options:n.settings["twig options"]}),function(e){return r.render(e)}},e.exports.renderFile=function(t,n,r){"function"==typeof n&&(r=n,n={}),n=n||{};var o=n.settings||{},i={path:t,base:o.views,load:function(e){r(null,""+e.render(n))}},s=o["twig options"];if(s)for(var a in s)s.hasOwnProperty(a)&&(i[a]=s[a]);e.exports.twig(i)},e.exports.__express=e.exports.renderFile,e.exports.cache=function(t){e.cache=t},e.exports.path=e.path,e.exports.filters=e.filters,e}}])});try{var twig=Twig.twig,patternNavTemplate=document.getElementById("pl-pattern-nav-template").innerHTML,ishControlsTemplate=document.getElementById("pl-ish-controls-template").innerHTML,patternLabNavTarget=document.getElementById("pl-pattern-nav-target"),sgControlsTarget=document.getElementById("sg-controls"),patternNavRendered,patternNavTwigTemplate,ishTemplateCompiled,ishTemplateRendered;patternNavTwigTemplate=twig({data:patternNavTemplate}),patternNavRendered=patternNavTwigTemplate.render(navItems),ishTemplateCompiled=Hogan.compile(ishControlsTemplate),ishTemplateRendered=ishTemplateCompiled.render(ishControls),patternLabNavTarget.innerHTML=patternNavRendered,sgControlsTarget.innerHTML=ishTemplateRendered}catch(e){var message="<h1>Nothing Here Yet</h1><p>Please generate your site before trying to view it.</p>";document.getElementById("pl-pattern-nav-target").innerHTML=message}var urlHandler={skipBack:!1,targetOrigin:"file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host,getFileName:function(e,t){var n="patterns",r="";if(void 0===e)return r;if(void 0===t&&(t=!0),"all"==e)return"styleguide/html/styleguide.html";if("snapshots"==e)return"snapshots/index.html";var o=e.indexOf("viewall-")!=-1?viewAllPaths:patternPaths,i=e.replace("viewall-",""),s=this.getPatternInfo(i,o),a=s[0],p=s[1];if(void 0!==o[a]&&void 0!==o[a][p])r=o[a][p];else if(void 0!==o[a])for(var l in o[a])if(l.indexOf(p)!=-1){r=o[a][l];break}if(""===r)return r;var c=/\//g;if(e.indexOf("viewall-")!==-1&&0===e.indexOf("viewall-")&&""!==r)r=n+"/"+r.replace(c,"-")+"/index.html";else if(""!==r&&(r=n+"/"+r.replace(c,"-")+"/"+r.replace(c,"-"),t)){var u=void 0!==config.outputFileSuffixes&&void 0!==config.outputFileSuffixes.rendered?config.outputFileSuffixes.rendered:"";r=r+u+".html"}return r},getPatternInfo:function(e,t){for(var n=e.split("-"),r=1,o=n.length,i=n[0];void 0===t[i]&&r<o;)i+="-"+n[r],r++;var s=e.slice(i.length+1,e.length);return[i,s]},getRequestVars:function(){var e=new function(e){if(e.length>1)for(var t,n=0,r=e.substr(1).split("&");n<r.length;n++)t=r[n].split("="),this[unescape(t[0])]=t.length>1?unescape(t[1]):""}(window.location.search);return e},pushPattern:function(e,t){var n={pattern:e},r=urlHandler.getFileName(e),o=window.location.pathname;o="file"===window.location.protocol?o.replace("/public/index.html","public/"):o.replace(/\/index\.html/,"/");var i=window.location.protocol+"//"+window.location.host+o+r;if(t!=i){var s=JSON.stringify({event:"patternLab.updatePath",path:r});document.getElementById("sg-viewport").contentWindow.postMessage(s,urlHandler.targetOrigin)}else{var a="file:"==window.location.protocol?null:window.location.protocol+"//"+window.location.host+window.location.pathname.replace("index.html","")+"?p="+e;void 0!==history.pushState&&history.pushState(n,null,a),document.getElementById("title").innerHTML="Pattern Lab - "+e,null!==document.getElementById("sg-raw")&&document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(e))}},popPattern:function(e){var t,n=e.state;if(null===n)return void(this.skipBack=!1);null!==n&&(t=n.pattern);var r="";r=this.getFileName(t),""===r&&(r="styleguide/html/styleguide.html");var o=JSON.stringify({event:"patternLab.updatePath",path:r});document.getElementById("sg-viewport").contentWindow.postMessage(o,urlHandler.targetOrigin),document.getElementById("title").innerHTML="Pattern Lab - "+t,null!==document.getElementById("sg-raw")&&document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(t))}};window.onpopstate=function(e){urlHandler.skipBack=!0,urlHandler.popPattern(e)};var modalViewer={active:!1,switchText:!0,template:"info",patternData:{},targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,onReady:function(){Dispatcher.addListener("insertPanels",modalViewer.insert),$(window).on("resize",function(){"false"===DataSaver.findValue("modalActive")&&modalViewer.slide($("#sg-modal-container").outerHeight())}),$("#sg-t-patterninfo").click(function(e){e.preventDefault(),$("#sg-tools-toggle").removeClass("active"),$(this).parents("ul").removeClass("active"),modalViewer.toggle()}),$("#sg-modal-close-btn").on("click",function(e){e.preventDefault(),obj=JSON.stringify({event:"patternLab.annotationsHighlightHide"}),document.getElementById("sg-viewport").contentWindow.postMessage(obj,modalViewer.targetOrigin),modalViewer.close()}),"true"===DataSaver.findValue("modalActive")&&(modalViewer.active=!0,$("#sg-t-patterninfo").html("Hide Pattern Info")),modalViewer.hide();var e=urlHandler.getRequestVars();void 0===e.view||"code"!==e.view&&"c"!==e.view||modalViewer.queryPattern(),void 0===e.view||"annotations"!==e.view&&"a"!==e.view||modalViewer.queryPattern()},toggle:function(){modalViewer.active===!1?modalViewer.queryPattern():(obj=JSON.stringify({event:"patternLab.annotationsHighlightHide"}),document.getElementById("sg-viewport").contentWindow.postMessage(obj,modalViewer.targetOrigin),modalViewer.close())},open:function(){modalViewer.close(),DataSaver.updateValue("modalActive","true"),modalViewer.active=!0,$("#sg-t-"+modalViewer.template+" .sg-checkbox").addClass("active"),$("#sg-modal-container").addClass("active"),modalViewer.show()},close:function(){var e;DataSaver.updateValue("modalActive","false"),modalViewer.active=!1,$("#sg-modal-container").removeClass("active"),$(".sg-checkbox").removeClass("active"),modalViewer.hide(),$("#sg-t-patterninfo").html("Show Pattern Info"),e=JSON.stringify({event:"patternLab.patternModalClose"}),document.getElementById("sg-viewport").contentWindow.postMessage(e,modalViewer.targetOrigin)},hide:function(){modalViewer.slide($("#sg-modal-container").outerHeight()+30)},insert:function(e,t,n,r){if(n){var o=JSON.stringify({event:"patternLab.patternModalInsert",patternPartial:t,modalContent:e.outerHTML});document.getElementById("sg-viewport").contentWindow.postMessage(o,modalViewer.targetOrigin)}else $("#sg-modal-content").html(e),modalViewer.open();r===!0&&$("#sg-t-patterninfo").html("Hide Pattern Info")},refresh:function(e,t,n){t&&modalViewer.hide(),panelsViewer.gatherPanels(e,t,n)},slide:function(e){e=0===e?0:-e,$("#sg-modal-container").css("bottom",e)},slideToAnnotation:function(e){for(els=document.querySelectorAll("#sg-annotations > .sg-annotations-list > li"),i=0;i<els.length;++i)els[i].classList.remove("active");for(i=0;i<els.length;++i)i+1==e&&(els[i].classList.add("active"),$(".sg-pattern-extra-info").animate({scrollTop:els[i].offsetTop-10},600))},show:function(){modalViewer.slide(0)},queryPattern:function(e){(void 0===e||e)&&(e=!0,DataSaver.updateValue("modalActive","true"),modalViewer.active=!0);var t=JSON.stringify({event:"patternLab.patternQuery",switchText:e});document.getElementById("sg-viewport").contentWindow.postMessage(t,modalViewer.targetOrigin)},receiveIframeMessage:function(e){if("file:"===window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host){var t={};try{t="string"!=typeof e.data?e.data:JSON.parse(e.data)}catch(n){}void 0!==t.event&&"patternLab.pageLoad"==t.event?modalViewer.active===!1&&void 0!==t.patternpartial&&0===t.patternpartial.indexOf("viewall-")&&void 0!==config.defaultShowPatternInfo&&config.defaultShowPatternInfo?modalViewer.queryPattern(!1):modalViewer.active===!0&&modalViewer.queryPattern():void 0!==t.event&&"patternLab.patternQueryInfo"==t.event?modalViewer.refresh(t.patternData,t.iframePassback,t.switchText):void 0!==t.event&&"patternLab.annotationNumberClicked"==t.event&&modalViewer.slideToAnnotation(t.displayNumber)}}};$(document).ready(function(){modalViewer.onReady()}),window.addEventListener("message",modalViewer.receiveIframeMessage,!1);var panelsUtil={addClickEvents:function(e,t){for(var n=e.querySelectorAll("#sg-"+t+"-tabs li"),r=0;r<n.length;++r)n[r].onclick=function(e){e.preventDefault();var t=this.getAttribute("data-patternpartial"),n=this.getAttribute("data-panelid");panelsUtil.show(t,n)};return e},show:function(e,t){var n;for(n=document.querySelectorAll("#sg-"+e+"-tabs li"),i=0;i<n.length;++i)n[i].classList.remove("sg-tab-title-active");for(n=document.querySelectorAll("#sg-"+e+"-panels div.sg-tabs-panel"),i=0;i<n.length;++i)n[i].style.display="none";document.getElementById("sg-"+e+"-"+t+"-tab").classList.add("sg-tab-title-active"),document.getElementById("sg-"+e+"-"+t+"-panel").style.display="flex"}},PrismLanguages={languages:[],get:function(e){var t;for(i=0;i<this.languages.length;++i)if(t=this.languages[i],void 0!==t[e])return t[e];return"markup"},add:function(e){for(var t in e)if(e.hasOwnProperty(t))for(i=0;i<this.languages.length;++i)if(void 0!==this.languages[i][t])return void(this.languages[i][t]=e[t]);this.languages.push(e)}};PrismLanguages.add({twig:"markup"}),PrismLanguages.add({mustache:"markup"});var Panels={panels:[],count:function(){return this.panels.length},get:function(){return JSON.parse(JSON.stringify(this.panels))},add:function(e){for(i=0;i<this.panels.length;++i)if(e.id===this.panels[i].id)return;this.panels.push(e)}},fileSuffixPattern=void 0!==config.outputFileSuffixes&&void 0!==config.outputFileSuffixes.rawTemplate?config.outputFileSuffixes.rawTemplate:"",fileSuffixMarkup=void 0!==config.outputFileSuffixes&&void 0!==config.outputFileSuffixes.markupOnly?config.outputFileSuffixes.markupOnly:".markup-only";Panels.add({id:"sg-panel-pattern","default":!0,templateID:"pl-panel-template-code",httpRequest:!0,httpRequestReplace:fileSuffixPattern,httpRequestCompleted:!1,prismHighlight:!0,keyCombo:"ctrl+shift+u"}),Panels.add({id:"sg-panel-html",name:"HTML","default":!1,templateID:"pl-panel-template-code",httpRequest:!0,httpRequestReplace:fileSuffixMarkup+".html",httpRequestCompleted:!1,prismHighlight:!0,language:"markup",keyCombo:"ctrl+shift+y"}),Dispatcher.trigger("setupPanels");var panelsViewer={targetOrigin:"file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,initCopy:!1,initMoveTo:0,checkPanels:function(e,t,n,r){for(var o=0,i=0;i<e.length;++i)void 0!==e[i].content&&o++;o===Panels.count()&&panelsViewer.renderPanels(e,t,n,r)},gatherPanels:function(e,t,n){Dispatcher.addListener("checkPanels",panelsViewer.checkPanels);for(var r,o,i,s,a=Panels.get(),p=0;p<a.length;++p)if(s=a[p],void 0===s.name&&(s.name=e.patternEngineName||e.patternExtension,s.httpRequestReplace=s.httpRequestReplace+"."+e.patternExtension,s.language=e.patternExtension),void 0!==s.templateID&&s.templateID)if(void 0!==s.httpRequest&&s.httpRequest){var l=urlHandler.getFileName(e.patternPartial,!1),c=new XMLHttpRequest;c.onload=function(e,s,a,p){return function(){prismedContent=Prism.highlight(this.responseText,Prism.languages.html),r=document.getElementById(s[e].templateID),o=Hogan.compile(r.innerHTML),i=o.render({language:"html",code:prismedContent}),s[e].content=i,Dispatcher.trigger("checkPanels",[s,a,t,n])}}(p,a,e,t),c.open("GET",l+s.httpRequestReplace+"?"+(new Date).getTime(),!0),c.send()}else r=document.getElementById(s.templateID),o=Hogan.compile(r.innerHTML),i=o.render(e),a[p].content=i,Dispatcher.trigger("checkPanels",[a,e,t,n])},renderPanels:function(e,t,n,r){var o,i,s,a,p,l,c,u,f,d,h=t.patternPartial;for(t.panels=e,n||0!==t.patternDesc.length||(t.patternDesc="This pattern doesn't have a description."),t.patternNameCaps=t.patternName.toUpperCase(),f=document.createElement("div"),f.innerHTML=t.patternMarkup,p=1,t.annotations=[],delete t.patternMarkup,d=0;d<comments.comments.length;++d)u=comments.comments[d],c=f.querySelectorAll(u.el),c.length>0&&(a={displayNumber:p,el:u.el,title:u.title,comment:u.comment},t.annotations.push(a),p++);if(t.annotations.length>0){var g=JSON.stringify({event:"patternLab.annotationsHighlightShow",annotations:t.annotations});document.getElementById("sg-viewport").contentWindow.postMessage(g,panelsViewer.targetOrigin)}if(t.lineage.length>0)for(d=0;d<t.lineage.length;++d)d<t.lineage.length-1&&(t.lineage[d].hasComma=!0);if(t.lineageR.length>0)for(d=0;d<t.lineageR.length;++d)d<t.lineageR.length-1&&(t.lineageR[d].hasComma=!0);for(t.patternDescExists=t.patternDesc.length>0||void 0!==t.patternDescAdditions&&t.patternDescAdditions.length>0,t.lineageExists=0!==t.lineage.length,t.lineageRExists=0!==t.lineageR.length,t.patternStateExists=t.patternState.length>0,t.annotationExists=t.annotations.length>0,t.descBlockExists=t.patternDescExists||t.lineageExists||t.lineageRExists||t.patternStateExists||t.annotationExists,t.isPatternView=n===!1,o=document.getElementById("pl-panel-template-base"),i=Hogan.compile(o.innerHTML),s=i.render(t),l=document.createElement("div"),l.className="sg-modal-content-inner",l.innerHTML=s,s=l,s=panelsUtil.addClickEvents(s,h),d=0;d<e.length;++d)panel=e[d],panelTab="#sg-"+h+"-"+panel.id+"-tab",panelBlock="#sg-"+h+"-"+panel.id+"-panel",
null!==s.querySelector(panelTab)&&panel["default"]&&(s.querySelector(panelTab).classList.add("sg-tab-title-active"),s.querySelector(panelBlock).style.display="block");$("#sg-code-lineage-fill a, #sg-code-lineager-fill a",s).on("click",function(e){e.preventDefault();var t=JSON.stringify({event:"patternLab.updatePath",path:urlHandler.getFileName($(this).attr("data-patternpartial"))});document.getElementById("sg-viewport").contentWindow.postMessage(t,panelsViewer.targetOrigin)}),Dispatcher.trigger("insertPanels",[s,h,n,r])}},patternFinder={data:[],active:!1,init:function(){for(var e in patternPaths)if(patternPaths.hasOwnProperty(e))for(var t in patternPaths[e]){var n={};n.patternPartial=e+"-"+t,n.patternPath=patternPaths[e][t],this.data.push(n)}var r=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.nonword(e.patternPartial)},queryTokenizer:Bloodhound.tokenizers.nonword,limit:10,local:this.data});r.initialize(),$("#sg-find .typeahead").typeahead({highlight:!0},{displayKey:"patternPartial",source:r.ttAdapter()}).on("typeahead:selected",patternFinder.onSelected).on("typeahead:autocompleted",patternFinder.onAutocompleted)},passPath:function(e){patternFinder.closeFinder();var t=JSON.stringify({event:"patternLab.updatePath",path:urlHandler.getFileName(e.patternPartial)});document.getElementById("sg-viewport").contentWindow.postMessage(t,urlHandler.targetOrigin)},onSelected:function(e,t){patternFinder.passPath(t)},onAutocompleted:function(e,t){patternFinder.passPath(t)},toggleFinder:function(){patternFinder.active?patternFinder.closeFinder():patternFinder.openFinder()},openFinder:function(){patternFinder.active=!0,$("#sg-find .typeahead").val(""),$("#sg-find").addClass("show-overflow")},closeFinder:function(){patternFinder.active=!1,document.activeElement.blur(),$("#sg-find").removeClass("show-overflow"),$("#sg-find .typeahead").val("")},receiveIframeMessage:function(e){if("file:"===window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host){var t={};try{t="string"!=typeof e.data?e.data:JSON.parse(e.data)}catch(n){}return void 0!==t.event&&"patternLab.keyPress"==t.event&&"ctrl+shift+f"==t.keyPress?(patternFinder.toggleFinder(),!1):void 0}}};if(patternFinder.init(),window.addEventListener("message",patternFinder.receiveIframeMessage,!1),$("#sg-find .typeahead").focus(function(){patternFinder.active||patternFinder.openFinder()}),$("#sg-find .typeahead").blur(function(){patternFinder.closeFinder()}),self!=top){var path=window.location.toString(),parts=path.split("?"),options={event:"patternLab.pageLoad",path:parts[0]};patternData=document.getElementById("sg-pattern-data-footer").innerHTML,patternData=JSON.parse(patternData),options.patternpartial=void 0!==patternData.patternPartial?patternData.patternPartial:"all",""!==patternData.lineage&&(options.lineage=patternData.lineage);var targetOrigin="file:"==window.location.protocol?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(options,targetOrigin);for(var aTags=document.getElementsByTagName("a"),i=0;i<aTags.length;i++)aTags[i].onclick=function(e){var t=this.getAttribute("href"),n=this.getAttribute("target");if(void 0===n||"_parent"!=n&&"_blank"!=n){if(!t||"#"===t)return e.preventDefault(),!1;e.preventDefault(),window.location.replace(t)}else;}}window.addEventListener("message",receiveIframeMessage,!1),function(e){function t(){var e=$(".sg-acc-panel.active").first(),t=(e.height(),v-P);e.height(t)}function n(){s(),p(),O=!1,c(d(w,500))}function r(){s(),p(),O=!1,c(d(500,800))}function o(){s(),p(),O=!1,c(d(800,1200))}function i(){c(d(w,m))}function s(){S=!1,clearInterval(A),A=!1}function a(){S=!0,A=setInterval(i,800)}function p(){var e=k.width();N=!1,k.removeClass("hay-mode"),$("#sg-gen-container").removeClass("hay-mode"),c(Math.floor(e))}function l(){N=!0,$("#sg-gen-container").removeClass("vp-animate").width(w+b),k.removeClass("vp-animate").width(w);window.setTimeout(function(){$("#sg-gen-container").addClass("hay-mode").width(x+b),k.addClass("hay-mode").width(x),setInterval(function(){var e=k.width();f(e)},100)},200)}function c(e,t){var n;n=e>x?x:e<w?w:e,t===!1?$("#sg-gen-container,#sg-viewport").removeClass("vp-animate"):$("#sg-gen-container,#sg-viewport").addClass("vp-animate"),$("#sg-gen-container").width(n+b),k.width(n);var r="file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,o=JSON.stringify({event:"patternLab.resize",resize:"true"});document.getElementById("sg-viewport").contentWindow.postMessage(o,r),f(n),u(n)}function u(e){DataSaver.findValue("vpWidth")?DataSaver.updateValue("vpWidth",e):DataSaver.addValue("vpWidth",e)}function f(e,t,n){var r,o;"em"===t?(r=e,o=Math.floor(e*E)):(o=e,r=e/E),"updatePxInput"===n?T.val(o):"updateEmInput"===n?_.val(r.toFixed(2)):(_.val(r.toFixed(2)),T.val(o))}function d(e,t){return Math.floor(Math.random()*(t-e)+e)}function h(e){$("#sg-viewport").width(e),$("#sg-gen-container").width(1*e+14),f(e)}function g(){$(".sg-nav-container, .sg-nav-toggle, .sg-acc-handle, .sg-acc-panel").removeClass("active"),patternFinder.closeFinder()}function y(e){if("file:"===window.location.protocol||e.origin===window.location.protocol+"//"+window.location.host){var t={};try{t="string"!=typeof e.data?e.data:JSON.parse(e.data)}catch(i){}if(void 0!==t.event)if("patternLab.pageLoad"==t.event)urlHandler.skipBack||void 0!==history.state&&null!==history.state&&history.state.pattern===t.patternpartial||urlHandler.pushPattern(t.patternpartial,t.path),urlHandler.skipBack=!1;else if("patternLab.keyPress"==t.event){if("ctrl+shift+s"==t.keyPress)n();else if("ctrl+shift+m"==t.keyPress)r();else if("ctrl+shift+l"==t.keyPress)o();else if("ctrl+shift+d"==t.keyPress)S?s():a();else if("ctrl+shift+h"==t.keyPress)N?p():l();else if("ctrl+shift+0"==t.keyPress)c(320,!0);else if(found==t.keyPress.match(/ctrl\+shift\+([1-9])/)){var u=j[found[1]-1],f=u.indexOf("px")!==-1?"px":"em";u=u.replace(f,"");var d="px"===f?1*u:u*E;c(d,!0)}return!1}}}var m=document.body.clientWidth,v=$(document).height(),w=parseInt(config.ishMinimum),x=parseInt(config.ishMaximum),b=14,k=$("#sg-viewport"),T=$(".sg-size-px"),_=$(".sg-size-em"),E=void 0!==config.ishFontSize?parseInt(config.ishFontSize):parseInt($("body").css("font-size")),P=$(".sg-header").height(),A=!1,S=!1,O=!0,N=!1;$(e).resize(function(){m=document.body.clientWidth,v=$(document).height(),t(),O===!0&&c(m,!1)}),$(".sg-acc-handle").on("click",function(e){e.preventDefault();var n=$(this),r=n.next(".sg-acc-panel"),o=n.parent().parent().hasClass("sg-acc-panel");o||($(".sg-acc-handle").not(n).removeClass("active"),$(".sg-acc-panel").not(r).removeClass("active")),n.toggleClass("active"),r.toggleClass("active"),t()}),$(".sg-nav-toggle").on("click",function(e){e.preventDefault(),$(".sg-nav-container").toggleClass("active")}),$("#sg-t-toggle").on("click",function(e){e.preventDefault(),$(this).parents("ul").toggleClass("active")}),$("#sg-size-toggle").on("click",function(e){e.preventDefault(),$(this).parents("ul").toggleClass("active")}),$(".sg-size[data-size]").on("click",function(e){e.preventDefault(),s(),p(),O=!1;var t=$(this).attr("data-size");t.indexOf("px")>-1&&(E=1),t=t.replace(/[^\d.-]/g,""),c(Math.floor(t*E))}),$("#sg-size-s").on("click",function(e){e.preventDefault(),n()}),jwerty.key("ctrl+shift+s",function(e){return n(),!1}),$("#sg-size-m").on("click",function(e){e.preventDefault(),r()}),jwerty.key("ctrl+shift+m",function(e){return o(),!1}),$("#sg-size-l").on("click",function(e){e.preventDefault(),o()}),jwerty.key("ctrl+shift+l",function(e){return o(),!1}),$("#sg-size-full").on("click",function(e){e.preventDefault(),s(),p(),O=!0,c(m)}),$("#sg-size-random").on("click",function(e){e.preventDefault(),s(),p(),O=!1,c(d(w,m))}),$("#sg-size-disco").on("click",function(e){e.preventDefault(),p(),O=!1,S?s():a()}),jwerty.key("ctrl+shift+d",function(e){return S?s():a(),!1}),$("#sg-size-hay").on("click",function(e){e.preventDefault(),s(),N?p():l()}),jwerty.key("ctrl+shift+h",function(e){N?p():l()}),T.on("keydown",function(e){var t=Math.floor($(this).val());38===e.keyCode?(t++,c(t,!1)):40===e.keyCode?(t--,c(t,!1)):13===e.keyCode&&(e.preventDefault(),c(t),$(this).blur())}),T.on("keyup",function(){var e=Math.floor($(this).val());f(e,"px","updateEmInput")}),_.on("keydown",function(e){var t=parseFloat($(this).val());38===e.keyCode?(t++,c(Math.floor(t*E),!1)):40===e.keyCode?(t--,c(Math.floor(t*E),!1)):13===e.keyCode&&(e.preventDefault(),c(Math.floor(t*E)))}),_.on("keyup",function(){var e=parseFloat($(this).val());f(e,"em","updatePxInput")}),jwerty.key("ctrl+shift+0",function(e){return e.preventDefault(),c(320,!0),!1});var j=[];$("#sg-mq a").each(function(e){j.push($(this).html()),$(this).on("click",function(e,t){return function(e){e.preventDefault();var n=$(t).html(),r=n.indexOf("px")!==-1?"px":"em";n=n.replace(r,"");var o="px"===r?1*n:n*E;c(o,!0)}}(e,this)),jwerty.key("ctrl+shift+"+(e+1),function(e){return function(t){var n=$(e).html(),r=n.indexOf("px")!==-1?"px":"em";n=n.replace(r,"");var o="px"===r?1*n:n*E;return c(o,!0),!1}}(this))}),$("#sg-gen-container").on("transitionend webkitTransitionEnd",function(e){var t="file:"===window.location.protocol?"*":window.location.protocol+"//"+window.location.host,n=JSON.stringify({event:"patternLab.resize",resize:"true"});document.getElementById("sg-viewport").contentWindow.postMessage(n,t)}),$("#sg-gen-container").on("touchstart",function(e){}),$("#sg-rightpull").mousedown(function(e){var t=e.clientX,n=k.width();return O=!1,$("#sg-cover").css("display","block"),$("#sg-cover").mousemove(function(e){var r;r=n+2*(e.clientX-t),r>w&&(DataSaver.findValue("vpWidth")?DataSaver.updateValue("vpWidth",r):DataSaver.addValue("vpWidth",r),c(r,!1))}),!1}),$("body").mouseup(function(){$("#sg-cover").unbind("mousemove"),$("#sg-cover").css("display","none")});var D=$("#sg-viewport").width();$("#sg-gen-container").width(D);var M=screen.width;void 0!==window.orientation&&(M=0===window.orientation?screen.width:screen.height),$(window).width()==M&&"ontouchstart"in document.documentElement&&$(window).width()<=1024?$("#sg-rightpull-container").width(0):$("#sg-viewport").width(D-14),f($("#sg-viewport").width());var C=urlHandler.getRequestVars(),F=0,L=!0;void 0!==C.h||void 0!==C.hay?l():void 0!==C.d||void 0!==C.disco?a():void 0!==C.w||void 0!==C.width?(F=void 0!==C.w?C.w:C.width,F=F.indexOf("em")!==-1?Math.floor(Math.floor(F.replace("em",""))*E):Math.floor(F.replace("px","")),DataSaver.updateValue("vpWidth",F),h(F)):L&&(F=DataSaver.findValue("vpWidth"))&&h(F);var I=window.location.protocol+"//"+window.location.host+window.location.pathname.replace("index.html",""),R=void 0!==config.defaultPattern&&"string"==typeof config.defaultPattern&&config.defaultPattern.trim().length>0?config.defaultPattern:"all",z=I+"styleguide/html/styleguide.html?"+Date.now();if(void 0===C.p&&void 0===C.pattern||(R=void 0!==C.p?C.p:C.pattern),"all"!==R&&(patternPath=urlHandler.getFileName(R),z=""!==patternPath?I+patternPath+"?"+Date.now():z,document.getElementById("title").innerHTML="Pattern Lab - "+R,history.replaceState({pattern:R},null,null)),null!==document.getElementById("sg-raw")&&document.getElementById("sg-raw").setAttribute("href",urlHandler.getFileName(R)),urlHandler.skipBack=!0,document.getElementById("sg-viewport").contentWindow.location.replace(z),$("a[data-patternpartial]").on("click",function(e){e.preventDefault();var t=JSON.stringify({event:"patternLab.updatePath",path:urlHandler.getFileName($(this).attr("data-patternpartial"))});document.getElementById("sg-viewport").contentWindow.postMessage(t,urlHandler.targetOrigin),g()}),$("#sg-vp-wrap").click(function(){g()}),void 0!==window.orientation){var H=window.orientation;window.addEventListener("orientationchange",function(){window.orientation!=H&&($("#sg-gen-container").width($(window).width()),$("#sg-viewport").width($(window).width()),f($(window).width()),H=window.orientation)},!1)}window.addEventListener("message",y,!1)}(this);var pluginLoader={init:function(){for(var s,t,l,c,n,i=0;i<plugins.length;++i){var plugin=plugins[i];for(var key in plugin.templates)plugin.templates.hasOwnProperty(key)&&(t=document.getElementsByTagName("script"),l=t.length-1,s=t[l],n=document.createElement("script"),n.type="text/mustache",n.id=plugin.name.replace("/","-")+"-"+key+"-template",n.innerHTML=plugin.templates[key],s.parentNode.insertBefore(n,s.nextSibling));for(var k=0;k<plugin.stylesheets.length;++k)s=plugin.stylesheets[k],t=document.getElementsByTagName("link"),l=t.length-1,c=t[l],n=document.createElement("link"),n.type="text/css",n.rel="stylesheet",n.href="patternlab-components/"+plugin.name+"/"+s,n.media="screen",c.parentNode.insertBefore(n,c.nextSibling);$script(plugin.javascripts,plugin.name,eval("(function() { "+plugin.callback+" })")),$script.ready([plugin.name],eval("(function() { "+plugin.onready+" })"))}}};pluginLoader.init();